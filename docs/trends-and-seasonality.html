<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Chapter 4 Trends and Seasonality | Forecasting With Time Series Models Using R" />
<meta property="og:type" content="book" />
<meta property="og:image" content="/forecasting-logo.png" />
<meta property="og:description" content="Chapter 4 Trends and Seasonality | Forecasting With Time Series Models Using R" />


<meta name="author" content="David Ubilava" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="Chapter 4 Trends and Seasonality | Forecasting With Time Series Models Using R">

<title>Chapter 4 Trends and Seasonality | Forecasting With Time Series Models Using R</title>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css-0/msmb.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>
<script>
function copy_link(id) {
  var dummy = document.createElement('input'),
  text = window.location.href.split(/[?#]/)[0] + '#' + id;
  document.body.appendChild(dummy);
  dummy.value = text;
  dummy.select();
  document.execCommand('copy');
  document.body.removeChild(dummy);
  
  var tooltip = document.getElementById(id + '-tooltip');
  tooltip.innerHTML = 'Copied!';
}

function reset_tooltip(id) {
  var tooltip = document.getElementById(id);
  tooltip.innerHTML = 'Copy link';
}
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }

code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Forecasting With Time Series Models Using R<p><p class="author">David Ubilava</p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BE; Chapters</a>
<div class="dropdown-content">
<a href="index.html">Foreword</a>
<a href="forecasting-with-time-series-models.html">Forecasting With Time Series Models</a>
<a href="introduction-to-forecasting.html"><span class="toc-section-number">1</span> Introduction to Forecasting</a>
<a href="features-of-time-series-data.html"><span class="toc-section-number">2</span> Features of Time Series Data</a>
<a href="forecasting-methods-and-routines.html"><span class="toc-section-number">3</span> Forecasting Methods and Routines</a>
<a id="active-page" href="trends-and-seasonality.html"><span class="toc-section-number">4</span> Trends and Seasonality</a><ul class="toc-sections">
<li class="toc"><a href="#spurious-relationship"> Spurious Relationship</a></li>
<li class="toc"><a href="#modeling"> Modeling</a></li>
<li class="toc"><a href="#forecasting"> Forecasting</a></li>
</ul>
<a href="autoregressive-models.html"><span class="toc-section-number">5</span> Autoregressive Models</a>
<a href="vector-autoregressive-models.html"><span class="toc-section-number">6</span> Vector Autoregressive Models</a>
<a href="dynamic-factor-models.html"><span class="toc-section-number">7</span> Dynamic Factor Models</a>
<a href="threshold-autoregressive-models.html"><span class="toc-section-number">8</span> Threshold Autoregressive Models</a>
<a href="forecast-evaluation.html"><span class="toc-section-number">9</span> Forecast Evaluation</a>
<a href="forecast-combination.html"><span class="toc-section-number">10</span> Forecast Combination</a>
<a href="forecasting-using-r.html">Forecasting Using R</a>
<a href="tutorial-1-introduction-to-r.html">Tutorial 1: Introduction to R</a>
<a href="tutorial-2-data-management.html">Tutorial 2: Data Management</a>
<a href="tutorial-3-forecasting-methods-and-routines.html">Tutorial 3: Forecasting Methods and Routines</a>
<a href="tutorial-4-trends-and-seasonality.html">Tutorial 4: Trends and Seasonality</a>
<a href="tutorial-5-autoregressive-models.html">Tutorial 5: Autoregressive Models</a>
<a href="tutorial-6-vector-autoregressive-models.html">Tutorial 6: Vector Autoregressive Models</a>
<a href="tutorial-7-dynamic-factor-models.html">Tutorial 7: Dynamic Factor Models</a>
<a href="tutorial-8-threshold-autoregression.html">Tutorial 8: Threshold Autoregression</a>
<a href="tutorial-9-forecast-evaluation.html">Tutorial 9: Forecast Evaluation</a>
<a href="tutorial-10-forecast-combination.html">Tutorial 10: Forecast Combination</a>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="trends-and-seasonality" class="section level1" number="4">
<h1>
<span class="header-section-number">Chapter 4</span> Trends and Seasonality</h1>
<p>Economic time series usually are characterized by trending behavior, and often present a seasonal pattern as well. Trend is a unidirectional change of time series over an extended period of time that arises from the accumulation of information over time. Seasonality is a repeating pattern <em>within a calendar year</em> that arises from the links of technologies, preferences, and institutions to the calendar. Modeling and forecasting these time series features is a fairly straightforward task. But before we get to it, let’s discuss what may happen if we were to ignore the presence of trends and/or seasonality when analyzing the time series data.</p>
<div id="spurious-relationship" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Spurious Relationship<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('spurious-relationship')" onmouseout="reset_tooltip('spurious-relationship-tooltip')"><span class="tooltiptext" id="spurious-relationship-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Nothing about trending time series necessarily violates the classical linear regression model assumptions. The issue may arise, however, if an unobserved trending variable is simultaneously correlated with the dependent variable as well as one of the independent variables in a time series regression. In such case, we may find a (statistically significant) relationship between two or more unrelated economic variables simply because they are all trending. Such relationship is referred to a <em>spurious relationship</em>.</p>
<p>To illustrate, consider two trending variables: <span class="math display">\[y_t = \gamma t + \nu_t,\;~~\nu\sim N(0,\sigma_{\nu}^2),\]</span> and <span class="math display">\[x_t = \delta t + \upsilon_t,\;~~\upsilon\sim N(0,\sigma_{\upsilon}^2),\]</span> where <span class="math inline">\(Cov(\nu_t,\upsilon_t) = 0\)</span>. For simplicity, we can assume <span class="math inline">\(\sigma_{\nu}^2=\sigma_{\upsilon}^2=1\)</span>. Suppose, <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\delta\)</span> are some positive scalars, say, <span class="math inline">\(0.3\)</span> and <span class="math inline">\(0.5\)</span>, respectively. That is, <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> are trending in the same direction. Below is an example of such time series:
<img src="forecasting_files/figure-html/unnamed-chunk-6-1.png" width="624"></p>
<p>If we were to estimate <span class="math display">\[y_t = \alpha+\beta x_t + \varepsilon_t,\]</span> we are likely to find the relationship between the two – in this case <span class="math inline">\(\beta&gt;0\)</span> – even though, we know, the two are not related. To illustrate this, we will generate 1000 samples of size 120 for <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span>, and in each case we will estimate the parameter <span class="math inline">\(\beta\)</span>. The following graph illustrates the empirical distribution of these parameter estimates:
<img src="forecasting_files/figure-html/unnamed-chunk-7-1.png" width="624"></p>
<p>Luckily, we can easily “fix” the issue, by incorporating a trend in the regression: <span class="math display">\[y_t = \alpha+\beta x_t + \eta t + \varepsilon_t.\]</span> Once the trend is accounted for, the previously illustrated “bias” disappears. Using a similar simulation exercise as before, the following graph illustrates the empirical distribution of these parameter estimates:
<img src="forecasting_files/figure-html/unnamed-chunk-8-1.png" width="624"></p>
<p>In fact, this “fix” is equivalent to regressing a de-trended <span class="math inline">\(y\)</span> on a de-trended <span class="math inline">\(x\)</span>. To de-trend a variable, we first run a regression: <span class="math inline">\(y_t = \gamma_0 + \gamma_1 t + \nu_t\)</span>, and then obtain the fitted values for some fixed trend (typically zero), that is: <span class="math inline">\(\tilde{y}_t = \hat{\gamma}_0+\hat{\nu}_t\)</span>, where <span class="math inline">\(\hat{\gamma}_0\)</span> and <span class="math inline">\(\hat{\nu}_t\)</span> are the parameter estimate and the residuals from the foregoing regression.</p>
</div>
<div id="modeling" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Modeling<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('modeling')" onmouseout="reset_tooltip('modeling-tooltip')"><span class="tooltiptext" id="modeling-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>As seen, accounting for trends in a time series can help us resolve some regression issues. But a trend in and of itself can be an inherent feature of a times series. To that end, we can apply deterministic trends to forecast time series.</p>
<p>The simplest (and perhaps most frequently applied) model to account for the trending time series is a <em>linear</em> trend model: <span class="math display">\[y_t = \alpha + \beta t\]</span></p>
<p>Other likely candidate trend specifications are <em>polynomial</em> (e.g. quadratic, cubic, etc.), <em>exponential</em>, and <em>shifting</em> (or <em>switching</em>) trend models, respectively given by:
<span class="math display">\[\begin{aligned}
    y_t &amp;= \alpha + \beta_1 t + \beta_2 t^2 + \ldots + \beta_p t^p \\
    y_t &amp;= e^{\alpha + \beta t}\;~~\mbox{or}\;~~\ln{y_t} = \alpha + \beta t \\
    y_t &amp;= \alpha + \beta_1 t + \beta_2 (t-\tau)I(t&gt;\tau),\;~~\tau\in\mathsf{T}
    \end{aligned}\]</span></p>
<p>Of these, here we will primarily consider linear and quadratic trends. An exponential trend, from the standpoint of modeling and forecasting, is equivalent to a linear trend fitted to natural logarithm of the series. For a time series <span class="math inline">\(\{y_t: t=1,\ldots,T\}\)</span>, the natural logarithm is: <span class="math inline">\(z_t = \ln{y_t}\)</span>. Some of the benefits of such a transformation are that:</p>
<ul>
<li>they are easier to interpret (relative/percentage change).</li>
<li>they homogenizes the variance of the time series.</li>
<li>they may result in improved forecasting accuracy.</li>
</ul>
<p>Exponential trends are suitable when a time series is characterized by a stable relative change over time (e.g., when economic time series grow by 2% every year).</p>
<p>We will cover the shifting/switching trend models in another chapter.</p>
<p>Trends are (relatively) easy to model and forecast. Caution is needed, however, with (higher order) polynomial trends, as they may fit well in-sample, but cause major problems out-of-sample.</p>
<p>Consider a linear trend model with an additive error term: <span class="math display">\[y_t = \alpha + \beta t + \varepsilon_t\]</span> We estimate the model parameters, <span class="math inline">\(\mathbf{\theta}=\{\alpha,\beta\}\)</span>, by fitting the trend model to a time series using the least-squares regression: <span class="math display">\[\hat{\theta} = \operatorname*{argmin}_{\mathbf{\theta}} \sum_{t=1}^{T}\big(y_t - \alpha - \beta t\big)^2.\]</span> Fitted values are then given by: <span class="math display">\[\hat{y}_t = \hat{\alpha} + \hat{\beta} t\]</span></p>
<p>Seasonality is typically modeled as monthly or quarterly pattern, but can also be modeled as a higher frequency pattern (e.g. weekly). Some examples of time series with apparent seasonal patterns are:</p>
<ul>
<li>Agricultural production.</li>
<li>Sales of energy products.</li>
<li>Airfare (in non-pandemic times).</li>
</ul>
<p>One way to deal with the seasonality in data is to “remove” it prior to the use of the series (i.e., work with a seasonally adjusted time series). Indeed, some economic time series are only/also available in a seasonally-adjusted form.</p>
<p>Otherwise, and perhaps more interestingly, we can directly model seasonality in a regression setting by incorporating seasonal dummy variables, for example.</p>
<p>A seasonal model is given by: <span class="math display">\[y_t = \sum_{i=1}^{s}\gamma_i d_{it} + \varepsilon_t,\]</span>
where <span class="math inline">\(s\)</span> denotes the frequency of the data, and <span class="math inline">\(d_{it}\)</span> takes the value of 1 repeatedly after every <span class="math inline">\(s\)</span> periods, and such that <span class="math inline">\(\sum_{i} d_{it} = 1\)</span>, <span class="math inline">\(\forall t\)</span>.</p>
<p>Alternatively the seasonal model can be rewritten as: <span class="math display">\[y_t = \alpha + \sum_{i=1}^{s-1}\delta_i d_{it} + \varepsilon_t,\]</span> in which case <span class="math inline">\(\alpha\)</span> is an intercept of an omitted season, and <span class="math inline">\(\delta_i\)</span> represents a deviation from it during the <span class="math inline">\(i^{th}\)</span> season. This is a more typical form of a seasonal model.</p>
<p>Both variants of a seasonal model result in an identical fit and forecasts.</p>
<p>When dealing with weekly or daily data, the dummy variable approach of modeling seasonality may not be practical, nor efficient in most instances, as that will require estimating another 51 or 364 parameters. A way to model seasonality without giving up too many degrees of freedom is by using the so-called harmonic seasonal variables, which are a set of Fourier terms.</p>
<p>The Fourier terms can be applied to model seasonality at any frequency, indeed. Suppose, for example, we are working with monthly time series. A model with Fourier terms will have the following form: <span class="math display">\[y_t = \alpha+\sum_{k=1}^{K}\left[\beta_{1k}\sin\left(\frac{2\pi kt}{12}\right)+\beta_{2k}\cos\left(\frac{2\pi kt}{12}\right)\right]+\varepsilon_t,\]</span> where the value of <span class="math inline">\(K\)</span> can be determined using an information criterion (e.g., AIC or SIC).</p>
</div>
<div id="forecasting" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Forecasting<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('forecasting')" onmouseout="reset_tooltip('forecasting-tooltip')"><span class="tooltiptext" id="forecasting-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>The predictors of the deterministic trend or seasonal models are pre-determined, which means, after fitting the model, we can directly obtain the point and interval forecasts for any horizon <span class="math inline">\(h\)</span>.</p>
<p>If a linear trend model is fitted to the data, then any future realization of the stochastic process is assumed to follow the linear trend model: <span class="math display">\[y_{t+h} = \alpha + \beta (t+h) + \varepsilon_{t+h}.\]</span></p>
<p>An optimal forecast of <span class="math inline">\(y_{t+h}\)</span>, therefore, is given by: <span class="math display">\[y_{t+h|t} = E(y_{t+h}|\Omega_t) = E[\alpha + \beta (t+h) + \varepsilon_{t+h}] = \alpha + \beta (t+h).\]</span></p>
<p>The forecast error is: <span class="math display">\[e_{t+h|t} = y_{t+h} - y_{t+h|t} = \varepsilon_{t+h}\]</span></p>
<p>The forecast variance, then, is: <span class="math display">\[\sigma_{t+h|t}^2 = E(e_{t+h|t}^2) =  E(\varepsilon_{t+h}^2) = \hat{\sigma}^2,\;~~\forall\;h\]</span></p>
<p>From this, we can obtain interval forecast at any horizon, which is: <span class="math display">\[y_{t+h|t} \pm 1.96 \hat{\sigma}.\]</span></p>
<p>When using the dummy variable approach to model the seasonality, for example, a future realization of a random variable is: <span class="math display">\[y_{t+h} = \alpha + \sum_{i=1}^{s-1}\delta_i d_{i,t+h} + \varepsilon_{t+h}.\]</span></p>
<p>The optimal forecast of <span class="math inline">\(y_{t+h}\)</span> is: <span class="math display">\[y_{t+h|t} = E(y_{t+h}|\Omega_t) = \alpha + \sum_{i=1}^{s-1}\delta_i d_{i,t+h}\]</span></p>
<p>The forecast error is: <span class="math display">\[e_{t+h|t} = y_{t+h} - y_{t+h|t} = \varepsilon_{t+h}\]</span></p>
<p>The forecast variance is: <span class="math display">\[\sigma_{t+h|t}^2 = E(e_{t+h|t}^2) =  E(\varepsilon_{t+h}^2) = \hat{\sigma}^2,\;~~\forall\;h\]</span></p>
<p>The interval forecast is: <span class="math display">\[y_{t+h|t} \pm 1.96 \hat{\sigma}.\]</span></p>
<p>Several characteristics of forecasts from the considered deterministic models:</p>
<ul>
<li>they tend to understate uncertainty (at long horizons as the forecast interval doesn not widen with the horizon);</li>
<li>short-term trend forecasts can perform poorly; long-term trend forecasts typically perform poorly;</li>
<li>sometimes it may be beneficial, from the standpoint of achieving better accuracy, to forecast growth rates, and then reconstruct level forecasts.</li>
</ul>
</div>
</div>
<p style="text-align: center;">
<a href="forecasting-methods-and-routines.html"><button class="btn btn-default">Previous</button></a>
<a href="autoregressive-models.html"><button class="btn btn-default">Next</button></a>
</p>
<p class="build-date">Page built: 
2022-07-17
 using 
R version 4.1.2 (2021-11-01)
</p>
</div>
</div>



</body>
</html>
