<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Trends and Seasonality | Economic Time Series Modeling and Forecasting</title>
  <meta name="description" content="Chapter 3 Trends and Seasonality | Economic Time Series Modeling and Forecasting" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Trends and Seasonality | Economic Time Series Modeling and Forecasting" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Trends and Seasonality | Economic Time Series Modeling and Forecasting" />
  
  
  

<meta name="author" content="David Ubilava" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="deterministic-time-series-models.html"/>
<link rel="next" href="dynamic-time-series-models.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Economic Time Series Modeling and Forecasting</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preamble</a></li>
<li class="chapter" data-level="" data-path="preliminaries.html"><a href="preliminaries.html"><i class="fa fa-check"></i>Preliminaries</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-forecasting.html"><a href="introduction-to-forecasting.html"><i class="fa fa-check"></i><b>1</b> Introduction to Forecasting</a></li>
<li class="chapter" data-level="2" data-path="stochastic-process-and-time-series.html"><a href="stochastic-process-and-time-series.html"><i class="fa fa-check"></i><b>2</b> Stochastic Process and Time Series</a></li>
<li class="chapter" data-level="" data-path="deterministic-time-series-models.html"><a href="deterministic-time-series-models.html"><i class="fa fa-check"></i>Deterministic Time Series Models</a></li>
<li class="chapter" data-level="3" data-path="trends-and-seasonality.html"><a href="trends-and-seasonality.html"><i class="fa fa-check"></i><b>3</b> Trends and Seasonality</a><ul>
<li class="chapter" data-level="3.1" data-path="trends-and-seasonality.html"><a href="trends-and-seasonality.html#spurious-relationship"><i class="fa fa-check"></i><b>3.1</b> Spurious Relationship</a></li>
<li class="chapter" data-level="3.2" data-path="trends-and-seasonality.html"><a href="trends-and-seasonality.html#trends"><i class="fa fa-check"></i><b>3.2</b> Trends</a><ul>
<li class="chapter" data-level="3.2.1" data-path="trends-and-seasonality.html"><a href="trends-and-seasonality.html#modeling"><i class="fa fa-check"></i><b>3.2.1</b> Modeling</a></li>
<li class="chapter" data-level="3.2.2" data-path="trends-and-seasonality.html"><a href="trends-and-seasonality.html#forecasting"><i class="fa fa-check"></i><b>3.2.2</b> Forecasting</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="trends-and-seasonality.html"><a href="trends-and-seasonality.html#seasonality"><i class="fa fa-check"></i><b>3.3</b> Seasonality</a><ul>
<li class="chapter" data-level="3.3.1" data-path="trends-and-seasonality.html"><a href="trends-and-seasonality.html#modeling-1"><i class="fa fa-check"></i><b>3.3.1</b> Modeling</a></li>
<li class="chapter" data-level="3.3.2" data-path="trends-and-seasonality.html"><a href="trends-and-seasonality.html#forecasting-1"><i class="fa fa-check"></i><b>3.3.2</b> Forecasting</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="trends-and-seasonality.html"><a href="trends-and-seasonality.html#exercise"><i class="fa fa-check"></i><b>3.4</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dynamic-time-series-models.html"><a href="dynamic-time-series-models.html"><i class="fa fa-check"></i>Dynamic Time Series Models</a></li>
<li class="chapter" data-level="4" data-path="linear-autoregression.html"><a href="linear-autoregression.html"><i class="fa fa-check"></i><b>4</b> Linear Autoregression</a><ul>
<li class="chapter" data-level="4.1" data-path="linear-autoregression.html"><a href="linear-autoregression.html#modeling-2"><i class="fa fa-check"></i><b>4.1</b> Modeling</a><ul>
<li class="chapter" data-level="4.1.1" data-path="linear-autoregression.html"><a href="linear-autoregression.html#ar1"><i class="fa fa-check"></i><b>4.1.1</b> AR(1)</a></li>
<li class="chapter" data-level="4.1.2" data-path="linear-autoregression.html"><a href="linear-autoregression.html#ar2"><i class="fa fa-check"></i><b>4.1.2</b> AR(2)</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="linear-autoregression.html"><a href="linear-autoregression.html#forecasting-2"><i class="fa fa-check"></i><b>4.2</b> Forecasting</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="vector-autoregression.html"><a href="vector-autoregression.html"><i class="fa fa-check"></i><b>5</b> Vector Autoregression</a></li>
<li class="chapter" data-level="6" data-path="threshold-autoregression.html"><a href="threshold-autoregression.html"><i class="fa fa-check"></i><b>6</b> Threshold Autoregression</a></li>
<li class="chapter" data-level="" data-path="forecast-assessment.html"><a href="forecast-assessment.html"><i class="fa fa-check"></i>Forecast Assessment</a></li>
<li class="chapter" data-level="7" data-path="forecast-evaluation.html"><a href="forecast-evaluation.html"><i class="fa fa-check"></i><b>7</b> Forecast Evaluation</a></li>
<li class="chapter" data-level="8" data-path="forecast-combination.html"><a href="forecast-combination.html"><i class="fa fa-check"></i><b>8</b> Forecast Combination</a></li>
<li class="chapter" data-level="" data-path="appendix-introduction-to-r.html"><a href="appendix-introduction-to-r.html"><i class="fa fa-check"></i>Appendix: Introduction to R</a><ul>
<li class="chapter" data-level="8.1" data-path="appendix-introduction-to-r.html"><a href="appendix-introduction-to-r.html#data-management"><i class="fa fa-check"></i><b>8.1</b> Data Management</a></li>
<li class="chapter" data-level="8.2" data-path="appendix-introduction-to-r.html"><a href="appendix-introduction-to-r.html#data-visualisation"><i class="fa fa-check"></i><b>8.2</b> Data Visualisation</a></li>
<li class="chapter" data-level="8.3" data-path="appendix-introduction-to-r.html"><a href="appendix-introduction-to-r.html#regression-analysis"><i class="fa fa-check"></i><b>8.3</b> Regression Analysis</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Economic Time Series Modeling and Forecasting</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="trends-and-seasonality" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Trends and Seasonality</h1>
<p>Economic time series usually are characterized by trending behavior, and often present a seasonal pattern as well. Trend is a unidirectional change of time series over an extended period of time that arises from the accumulation of information over time. Seasonality is a repeating pattern <em>within a calendar year</em> that arises from the links of technologies, preferences, and institutions to the calendar. Modeling and forecasting these time series features is a fairly straightforward task. But before we get to it, let’s discuss what may happen if we were to ignore the presence of trends and/or seasonality when analyzing the time series data.</p>
<div id="spurious-relationship" class="section level2">
<h2><span class="header-section-number">3.1</span> Spurious Relationship</h2>
<p>Nothing about trending time series necessarily violates the classical linear regression model assumptions. The issue may arise, however, if an unobserved trending variable is simultaneously correlated with the dependent variable as well as one of the independent variables in a time series regression. In such case, we may find a (statistically significant) relationship between two or more unrelated economic variables simply because they are all trending. Such relationship is referred to a <em>spurious relationship</em>.</p>
<p>To illustrate, consider two trending variables: <span class="math display">\[y_t = \gamma t + \nu_t,\;~~\nu\sim N(0,\sigma_{\nu}^2),\]</span> and <span class="math display">\[x_t = \delta t + \upsilon_t,\;~~\upsilon\sim N(0,\sigma_{\upsilon}^2),\]</span> where <span class="math inline">\(Cov(\nu_t,\upsilon_t) = 0\)</span>. For simplicity, we can assume <span class="math inline">\(\sigma_{\nu}^2=\sigma_{\upsilon}^2=1\)</span>. Suppose, <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(\delta\)</span> are some positive scalars, say, <span class="math inline">\(0.3\)</span> and <span class="math inline">\(0.5\)</span>, respectively. That is, <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span> are trending in the same direction. Below is an example of such time series:
<img src="forecasting_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>If we were to estimate <span class="math display">\[y_t = \alpha+\beta x_t + \varepsilon_t,\]</span> we are likely to find the relationship between the two – in this case <span class="math inline">\(\beta&gt;0\)</span> – even though, we know, the two are not related. To illustrate this, we will generate 1000 samples of size 120 for <span class="math inline">\(y\)</span> and <span class="math inline">\(x\)</span>, and in each case we will estimate the parameter <span class="math inline">\(\beta\)</span>. The following graph illustrates the empirical distribution of these parameter estimates:
<img src="forecasting_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Luckily, we can easily “fix” the issue, by incorporating a trend in the regression: <span class="math display">\[y_t = \alpha+\beta x_t + \eta t + \varepsilon_t.\]</span> Once the trend is accounted for, the previously illustrated “bias” disappears. Using a similar simulation exercise as before, the following graph illustrates the empirical distribution of these parameter estimates:
<img src="forecasting_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>In fact, this “fix” is equivalent to regressing a de-trended <span class="math inline">\(y\)</span> on a de-trended <span class="math inline">\(x\)</span>. To de-trend a variable, we first run a regression: <span class="math inline">\(y_t = \gamma_0 + \gamma_1 t + \nu_t\)</span>, and then obtain the fitted values for some fixed trend (typically zero), that is: <span class="math inline">\(\tilde{y}_t = \hat{\gamma}_0+\hat{\nu}_t\)</span>, where <span class="math inline">\(\hat{\gamma}_0\)</span> and <span class="math inline">\(\hat{\nu}_t\)</span> are the parameter estimate and the residuals from the foregoing regression.</p>
</div>
<div id="trends" class="section level2">
<h2><span class="header-section-number">3.2</span> Trends</h2>
<div id="modeling" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Modeling</h3>
<p>As seen, accounting for trends in a time series can help us resolve some regression issues. But a trend in and of itself can be an inherent feature of a times series. To that end, we can apply deterministic trends to forecast time series.</p>
<p>The simplest (and perhaps most frequently applied) model to account for the trending time series is a <em>linear</em> trend model: <span class="math display">\[y_t = \alpha + \beta t\]</span></p>
<p>Other likely candidate trend specifications are <em>polynomial</em> (e.g. quadratic, cubic, etc.), <em>exponential</em>, and <em>shifting</em> (or <em>switching</em>) trend models, respectively given by:
<span class="math display">\[\begin{aligned}
    y_t &amp;= \alpha + \beta_1 t + \beta_2 t^2 + \ldots + \beta_p t^p \\
    y_t &amp;= e^{\alpha + \beta t}\;~~\mbox{or}\;~~\ln{y_t} = \alpha + \beta t \\
    y_t &amp;= \alpha + \beta_1 t + \beta_2 (t-\tau)I(t&gt;\tau),\;~~\tau\in\mathsf{T} 
    \end{aligned}\]</span></p>
<p>Of these, here we will primarily consider linear and quadratic trends. An exponential trend, from the standpoint of modeling and forecasting, is equivalent to a linear trend fitted to natural logarithm of the series. For a time series <span class="math inline">\(\{y_t: t=1,\ldots,T\}\)</span>, the natural logarithm is: <span class="math inline">\(z_t = \ln{y_t}\)</span>. Some of the benefits of such a transformation are that:</p>
<ul>
<li>they are easier to interpret (relative/percentage change).</li>
<li>they homogenizes the variance of the time series.</li>
<li>they may result in improved forecasting accuracy.</li>
</ul>
<p>Exponential trends are suitable when a time series is characterized by a stable relative change over time (e.g., when economic time series grow by 2% every year).</p>
<p>We will cover the shifting/switching trend models in another chapter.</p>
</div>
<div id="forecasting" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Forecasting</h3>
<p>Trends are (relatively) easy to model and forecast. Caution is needed, however, with (higher order) polynomial trends, as they may fit well in-sample, but cause major problems out-of-sample.</p>
<p>Consider a linear trend model with an additive error term: <span class="math display">\[y_t = \alpha + \beta t + \varepsilon_t\]</span> We estimate the model parameters, <span class="math inline">\(\mathbf{\theta}=\{\alpha,\beta\}\)</span>, by fitting the trend model to a time series using the least-squares regression: <span class="math display">\[\hat{\theta} = \operatorname*{argmin}_{\mathbf{\theta}} \sum_{t=1}^{T}\big(y_t - \alpha - \beta t\big)^2.\]</span> Fitted values are then given by: <span class="math display">\[\hat{y}_t = \hat{\alpha} + \hat{\beta} t\]</span></p>
<p>Any future realization of a random variable is assumed to follow a linear trend model: <span class="math display">\[y_{t+h} = \alpha + \beta (t+h) + \varepsilon_{t+h}.\]</span></p>
<p>An optimal forecast of <span class="math inline">\(y_{t+h}\)</span>, therefore, is given by: <span class="math display">\[y_{t+h|t} = E(y_{t+h}|\Omega_t) = E[\alpha + \beta (t+h) + \varepsilon_{t+h}] = \alpha + \beta (t+h).\]</span></p>
<p>The forecast error is: <span class="math display">\[e_{t+h|t} = y_{t+h} - y_{t+h|t} = \varepsilon_{t+h}\]</span></p>
<p>The forecast variance, then, is: <span class="math display">\[\sigma_{t+h|t}^2 = E(e_{t+h|t}^2) =  E(\varepsilon_{t+h}^2) = \hat{\sigma}^2,\;~~\forall\;h\]</span></p>
<p>From this, we can obtain interval forecast at any horizon, which is: <span class="math display">\[y_{t+h|t} \pm 1.96 \hat{\sigma}.\]</span></p>
<p>A few features of trend forecasts to note:</p>
<ul>
<li>they tend to understate uncertainty (at long horizons as the forecast interval doesn not widen with the horizon);</li>
<li>short-term trend forecasts can perform poorly; long-term trend forecasts typically perform poorly;</li>
<li>sometimes it may be beneficial, from the standpoint of achieving better accuracy, to forecast growth rates, and then reconstruct level forecasts.</li>
</ul>
</div>
</div>
<div id="seasonality" class="section level2">
<h2><span class="header-section-number">3.3</span> Seasonality</h2>
<div id="modeling-1" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Modeling</h3>
<p>Seasonality is typically modeled as monthly or quarterly pattern, but can also be modeled as a higher frequency pattern (e.g. weekly). Some examples of time series with apparent seasonal patterns are:</p>
<ul>
<li>Agricultural production.</li>
<li>Sales of energy products.</li>
<li>Airfare (in non-pandemic times).</li>
</ul>
<p>One way to deal with the seasonality in data is to “remove” it prior to the use of the series (i.e., work with a seasonally adjusted time series). Indeed, some economic time series are only/also available in a seasonally-adjusted form.</p>
<p>Otherwise, and perhaps more interestingly, we can directly model seasonality in a regression setting by incorporating seasonal dummy variables.</p>
<p>A seasonal model is given by: <span class="math display">\[y_t = \sum_{i=1}^{s}\gamma_i d_{it} + \varepsilon_t,\]</span>
where <span class="math inline">\(s\)</span> denotes the frequency of the data, and <span class="math inline">\(d_{it}\)</span> takes the value of 1 repeatedly after every <span class="math inline">\(s\)</span> periods, and such that <span class="math inline">\(\sum_{i} d_{it} = 1\)</span>, <span class="math inline">\(\forall t\)</span>.</p>
<p>Alternatively the seasonal model can be rewritten as: <span class="math display">\[y_t = \alpha + \sum_{i=1}^{s-1}\delta_i d_{it} + \varepsilon_t,\]</span> in which case <span class="math inline">\(\alpha\)</span> is an intercept of an omitted season, and <span class="math inline">\(\delta_i\)</span> represents a deviation from it during the <span class="math inline">\(i^{th}\)</span> season.</p>
<p>Both variants of the seasonal model result in an identical fit and forecasts.</p>
</div>
<div id="forecasting-1" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Forecasting</h3>
<p>Any future realization of a random variable that i assumed to follow a seasonal model is: <span class="math display">\[y_{t+h} = \alpha + \sum_{i=1}^{s-1}\delta_i d_{i,t+h} + \varepsilon_{t+h}.\]</span></p>
<p>The optimal forecast of <span class="math inline">\(y_{t+h}\)</span> is: <span class="math display">\[y_{t+h|t} = E(y_{t+h}|\Omega_t) = \alpha + \sum_{i=1}^{s-1}\delta_i d_{i,t+h}\]</span></p>
<p>The forecast error is: <span class="math display">\[e_{t+h|t} = y_{t+h} - y_{t+h|t} = \varepsilon_{t+h}\]</span></p>
<p>The forecast variance is given by: <span class="math display">\[\sigma_{t+h|t}^2 = E(e_{t+h|t}^2) =  E(\varepsilon_{t+h}^2) = \hat{\sigma}^2,\;~~\forall\;h\]</span></p>
<p>The interval forecast at any horizon is: <span class="math display">\[y_{t+h|t} \pm 1.96 \hat{\sigma}.\]</span></p>
</div>
</div>
<div id="exercise" class="section level2">
<h2><span class="header-section-number">3.4</span> Exercise</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="trends-and-seasonality.html#cb1-1"></a><span class="co"># set the length of a time series to 180 (e.g., 15 years of monthly data)</span></span>
<span id="cb1-2"><a href="trends-and-seasonality.html#cb1-2"></a>n &lt;-<span class="st"> </span><span class="dv">180</span></span>
<span id="cb1-3"><a href="trends-and-seasonality.html#cb1-3"></a></span>
<span id="cb1-4"><a href="trends-and-seasonality.html#cb1-4"></a><span class="co"># set seed to 2 and generate a sequence of standard normal error terms</span></span>
<span id="cb1-5"><a href="trends-and-seasonality.html#cb1-5"></a><span class="kw">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb1-6"><a href="trends-and-seasonality.html#cb1-6"></a>e &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n)</span>
<span id="cb1-7"><a href="trends-and-seasonality.html#cb1-7"></a></span>
<span id="cb1-8"><a href="trends-and-seasonality.html#cb1-8"></a><span class="co"># suppose the data generating process of a time series is: </span></span>
<span id="cb1-9"><a href="trends-and-seasonality.html#cb1-9"></a><span class="co"># y_{t} = 0.7*y_{t-1}+0.01*t+e_{t}</span></span>
<span id="cb1-10"><a href="trends-and-seasonality.html#cb1-10"></a><span class="co"># simulate these series, assume y_{0} = 0.</span></span>
<span id="cb1-11"><a href="trends-and-seasonality.html#cb1-11"></a>y &lt;-<span class="st"> </span>e</span>
<span id="cb1-12"><a href="trends-and-seasonality.html#cb1-12"></a></span>
<span id="cb1-13"><a href="trends-and-seasonality.html#cb1-13"></a>y[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="fl">0.01</span><span class="op">+</span>e[<span class="dv">1</span>]</span>
<span id="cb1-14"><a href="trends-and-seasonality.html#cb1-14"></a></span>
<span id="cb1-15"><a href="trends-and-seasonality.html#cb1-15"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>n){</span>
<span id="cb1-16"><a href="trends-and-seasonality.html#cb1-16"></a>  y[i] &lt;-<span class="st"> </span><span class="fl">0.7</span><span class="op">*</span>y[i<span class="dv">-1</span>]<span class="op">+</span><span class="fl">0.05</span><span class="op">*</span>i<span class="fl">-0.0002</span><span class="op">*</span>i<span class="op">^</span><span class="dv">2</span><span class="op">+</span>e[i]</span>
<span id="cb1-17"><a href="trends-and-seasonality.html#cb1-17"></a>}</span>
<span id="cb1-18"><a href="trends-and-seasonality.html#cb1-18"></a></span>
<span id="cb1-19"><a href="trends-and-seasonality.html#cb1-19"></a><span class="co"># store the simulated series in a data.table, where the first column is a column of dates</span></span>
<span id="cb1-20"><a href="trends-and-seasonality.html#cb1-20"></a>dt &lt;-<span class="st"> </span><span class="kw">data.table</span>(<span class="dt">year=</span><span class="kw">seq</span>(<span class="kw">as.Date</span>(<span class="st">&quot;1980-01-01&quot;</span>),<span class="dt">by=</span><span class="st">&quot;quarter&quot;</span>,<span class="dt">along.with=</span>y),<span class="dt">y=</span>y,<span class="dt">trend=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span>n))</span>
<span id="cb1-21"><a href="trends-and-seasonality.html#cb1-21"></a></span>
<span id="cb1-22"><a href="trends-and-seasonality.html#cb1-22"></a><span class="co"># plot the series (using ggplot)</span></span>
<span id="cb1-23"><a href="trends-and-seasonality.html#cb1-23"></a><span class="kw">ggplot</span>(dt,<span class="kw">aes</span>(<span class="dt">x=</span>year,<span class="dt">y=</span>y))<span class="op">+</span></span>
<span id="cb1-24"><a href="trends-and-seasonality.html#cb1-24"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size=</span><span class="dv">1</span>)<span class="op">+</span></span>
<span id="cb1-25"><a href="trends-and-seasonality.html#cb1-25"></a><span class="st">  </span><span class="kw">theme_classic</span>()<span class="op">+</span></span>
<span id="cb1-26"><a href="trends-and-seasonality.html#cb1-26"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>),<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>))</span></code></pre></div>
<p><img src="forecasting_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="trends-and-seasonality.html#cb2-1"></a><span class="co"># suppose we think the linear trend model is appropriate; use the first 120 observations </span></span>
<span id="cb2-2"><a href="trends-and-seasonality.html#cb2-2"></a><span class="co"># to estimate trend, and using this estimatem generate forecasts for the remaining series</span></span>
<span id="cb2-3"><a href="trends-and-seasonality.html#cb2-3"></a>R &lt;-<span class="st"> </span><span class="kw">round</span>(.<span class="dv">75</span><span class="op">*</span>n)</span>
<span id="cb2-4"><a href="trends-and-seasonality.html#cb2-4"></a></span>
<span id="cb2-5"><a href="trends-and-seasonality.html#cb2-5"></a>reg &lt;-<span class="st"> </span><span class="kw">lm</span>(y[<span class="dv">1</span><span class="op">:</span>R]<span class="op">~</span>trend[<span class="dv">1</span><span class="op">:</span>R],<span class="dt">data=</span>dt)</span>
<span id="cb2-6"><a href="trends-and-seasonality.html#cb2-6"></a></span>
<span id="cb2-7"><a href="trends-and-seasonality.html#cb2-7"></a><span class="co"># store the vector of coefficients</span></span>
<span id="cb2-8"><a href="trends-and-seasonality.html#cb2-8"></a>theta &lt;-<span class="st"> </span>reg<span class="op">$</span>coefficients</span>
<span id="cb2-9"><a href="trends-and-seasonality.html#cb2-9"></a></span>
<span id="cb2-10"><a href="trends-and-seasonality.html#cb2-10"></a><span class="co"># calculate the residual standard deviation</span></span>
<span id="cb2-11"><a href="trends-and-seasonality.html#cb2-11"></a>sigma &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">crossprod</span>(reg<span class="op">$</span>residuals)<span class="op">/</span>(R<span class="dv">-2</span>))</span>
<span id="cb2-12"><a href="trends-and-seasonality.html#cb2-12"></a></span>
<span id="cb2-13"><a href="trends-and-seasonality.html#cb2-13"></a><span class="co"># generated and include in the dataset the fitted values and 90% CI bounds</span></span>
<span id="cb2-14"><a href="trends-and-seasonality.html#cb2-14"></a>dt[,<span class="st">`</span><span class="dt">:=</span><span class="st">`</span>(<span class="dt">yhat=</span>(theta[<span class="dv">1</span>]<span class="op">+</span>theta[<span class="dv">2</span>]<span class="op">*</span>trend))]</span>
<span id="cb2-15"><a href="trends-and-seasonality.html#cb2-15"></a>dt[,<span class="st">`</span><span class="dt">:=</span><span class="st">`</span>(<span class="dt">y.lo=</span>(yhat<span class="fl">-1.96</span><span class="op">*</span><span class="kw">as.vector</span>(sigma)),<span class="dt">y.hi=</span>(yhat<span class="fl">+1.96</span><span class="op">*</span><span class="kw">as.vector</span>(sigma)))]</span>
<span id="cb2-16"><a href="trends-and-seasonality.html#cb2-16"></a></span>
<span id="cb2-17"><a href="trends-and-seasonality.html#cb2-17"></a><span class="co"># set the fitted values of the in-sample range to NA</span></span>
<span id="cb2-18"><a href="trends-and-seasonality.html#cb2-18"></a>dt[trend <span class="op">&lt;=</span><span class="st"> </span>R,<span class="kw">c</span>(<span class="st">&quot;yhat&quot;</span>,<span class="st">&quot;y.lo&quot;</span>,<span class="st">&quot;y.hi&quot;</span>)] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb2-19"><a href="trends-and-seasonality.html#cb2-19"></a></span>
<span id="cb2-20"><a href="trends-and-seasonality.html#cb2-20"></a><span class="co"># re-arrange the dataset into the &quot;long&quot; format (helpful for plotting)</span></span>
<span id="cb2-21"><a href="trends-and-seasonality.html#cb2-21"></a>dt_long &lt;-<span class="st"> </span><span class="kw">melt</span>(dt[,.(year,y,yhat,y.lo,y.hi)],<span class="dt">id.vars=</span><span class="st">&quot;year&quot;</span>)</span>
<span id="cb2-22"><a href="trends-and-seasonality.html#cb2-22"></a></span>
<span id="cb2-23"><a href="trends-and-seasonality.html#cb2-23"></a><span class="co"># plot the out-of-sample forecasts along with the observed time series</span></span>
<span id="cb2-24"><a href="trends-and-seasonality.html#cb2-24"></a><span class="kw">ggplot</span>(dt_long,<span class="kw">aes</span>(<span class="dt">x=</span>year,<span class="dt">y=</span>value,<span class="dt">color=</span>variable,<span class="dt">linetype=</span>variable))<span class="op">+</span></span>
<span id="cb2-25"><a href="trends-and-seasonality.html#cb2-25"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">na.rm=</span>T,<span class="dt">size=</span><span class="dv">1</span>)<span class="op">+</span></span>
<span id="cb2-26"><a href="trends-and-seasonality.html#cb2-26"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;y&quot;</span>,<span class="st">&quot;yhat&quot;</span>,<span class="st">&quot;y.lo&quot;</span>,<span class="st">&quot;y.hi&quot;</span>),<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;time series&quot;</span>,<span class="st">&quot;point forecast&quot;</span>,<span class="st">&quot;lower bound&quot;</span>,<span class="st">&quot;upper bound&quot;</span>),<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;darkgray&quot;</span>,<span class="st">&quot;goldenrod&quot;</span>,<span class="st">&quot;black&quot;</span>,<span class="st">&quot;black&quot;</span>))<span class="op">+</span></span>
<span id="cb2-27"><a href="trends-and-seasonality.html#cb2-27"></a><span class="st">  </span><span class="kw">scale_linetype_manual</span>(<span class="dt">breaks =</span> <span class="kw">c</span>(<span class="st">&quot;y&quot;</span>,<span class="st">&quot;yhat&quot;</span>,<span class="st">&quot;y.lo&quot;</span>,<span class="st">&quot;y.hi&quot;</span>),<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;time series&quot;</span>,<span class="st">&quot;point forecast&quot;</span>,<span class="st">&quot;lower bound&quot;</span>,<span class="st">&quot;upper bound&quot;</span>),<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>))<span class="op">+</span></span>
<span id="cb2-28"><a href="trends-and-seasonality.html#cb2-28"></a><span class="st">  </span><span class="kw">theme_classic</span>()<span class="op">+</span></span>
<span id="cb2-29"><a href="trends-and-seasonality.html#cb2-29"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>),<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),<span class="dt">legend.position =</span> <span class="kw">c</span>(.<span class="dv">1</span>,.<span class="dv">9</span>),<span class="dt">legend.title=</span><span class="kw">element_blank</span>())</span></code></pre></div>
<p><img src="forecasting_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<!-- ## Serial Correlation -->
<!-- Another example of spurios regression in time series analysis is if we were to regress a non-stationary variables that follows the *random walk* process on another. Suppose $y$ and $x$ are such two variables: $$y_t = y_{t-1}+\nu_t,\;~~\nu_t\sim N(0,\sigma_{\nu}^2).$$ and $$x_t = x_{t-1}+\upsilon_t,\;~~\upsilon_t\sim N(0,\sigma_{\upsilon}^2),$$ where, again, $Cov(\nu_t,\upsilon_t)=0$, and for simplicity we assume that $\sigma_{\nu_t}^2=\sigma_{\upsilon}^2=1$. The following graph illustrates these variables: -->
<!-- ```{r echo=FALSE, message=FALSE, cache=TRUE} -->
<!-- set.seed(1) -->
<!-- y <- rnorm(n) -->
<!-- y <- cumsum(y) -->
<!-- set.seed(n) -->
<!-- x <- rnorm(n) -->
<!-- x <- cumsum(x) -->
<!-- df <- data.frame(tr=tr,x=x,y=y) -->
<!-- ggplot(df,aes(x=tr)) + -->
<!--   geom_line(aes(y=x),color="steelblue",size=.5) + -->
<!--   geom_line(aes(y=y),color="firebrick",size=.5) + -->
<!--   labs(x="t",y=expression(paste(y[t],", ",x[t],sep=""))) + -->
<!--   theme_classic() -->
<!-- ``` -->
<!-- If we were to estimate $$y_t = \alpha+\beta x_t + \varepsilon_t,$$ we wil likely (indeed, more likely than we should be) find the relationship between the two -- i.e., we will reject the null of $\beta=0$ more often than we should -- even though, we know, the two are not related. To illustrate the point, as before, let's simulate 1000 samples of size 120 for $y$ and $x$, and in each case estimate the parameter $\beta$. The following graph presents the empirical distribution of t-ratios associated with these parameter estimates: -->
<!-- ```{r echo=FALSE, message=FALSE, cache=TRUE} -->
<!-- tmat <- matrix(NA,r,1) -->
<!-- for(i in 1:r){ -->
<!--   set.seed(i) -->
<!--   y <- rnorm(n) -->
<!--   y <- cumsum(y) -->
<!--   set.seed(r+i) -->
<!--   x <- rnorm(n) -->
<!--   x <- cumsum(x) -->
<!--   spur <- lm(y~x) -->
<!--   tmat[i,] <- summary(spur)$coef[2,3] -->
<!-- } -->
<!-- tmat <- data.frame(tmat) -->
<!-- colnames(tmat) <- "t" -->
<!-- ggplot(tmat,aes(x=t)) + -->
<!--   geom_histogram(color="white",fill="darkgray",alpha=.5,binwidth=3) + -->
<!--   geom_vline(xintercept=c(-1.96,1.96),linetype=5,col="red")+ -->
<!--   coord_cartesian(xlim=c(-30,30))+ -->
<!--   labs(x="t-ratio") + -->
<!--   theme_classic() -->
<!-- ``` -->
<!-- As seen, at 5% significance level, the null of $\beta=0$ is rejected way more often than that. The "fix" here entails first-differencing the series, and regressing $\Delta y$ on $\Delta x$. Using a similar simulation exercise as before, the following graph illustrates the empirical distribution of the t-ratios: -->
<!-- ```{r echo=FALSE, message=FALSE, cache=TRUE} -->
<!-- tmat <- matrix(NA,r,1) -->
<!-- for(i in 1:r){ -->
<!--   set.seed(i) -->
<!--   y <- rnorm(n) -->
<!--   set.seed(r+i) -->
<!--   x <- rnorm(n) -->
<!--   spur <- lm(y~x) -->
<!--   tmat[i,] <- summary(spur)$coef[2,3] -->
<!-- } -->
<!-- tmat <- data.frame(tmat) -->
<!-- colnames(tmat) <- "t" -->
<!-- ggplot(tmat,aes(x=t)) + -->
<!--   geom_histogram(color="white",fill="steelblue",alpha=.5,binwidth=0.4) + -->
<!--   geom_vline(xintercept=c(-1.96,1.96),linetype=5,col="red")+ -->
<!--   coord_cartesian(xlim=c(-4,4))+ -->
<!--   labs(x="t-ratio") + -->
<!--   theme_classic() -->
<!-- ``` -->

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="deterministic-time-series-models.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dynamic-time-series-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["forecasting.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
