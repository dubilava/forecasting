<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Chapter 10 – Forecast Combination | Educated Guess" />
<meta property="og:type" content="book" />
<meta property="og:image" content="/forecasting-logo.png" />
<meta property="og:description" content="Forecasting With Time Series Models Using R" />


<meta name="author" content="David Ubilava" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="Forecasting With Time Series Models Using R">

<title>Chapter 10 – Forecast Combination | Educated Guess</title>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css-0/msmb.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>
<script>
function copy_link(id) {
  var dummy = document.createElement('input'),
  text = window.location.href.split(/[?#]/)[0] + '#' + id;
  document.body.appendChild(dummy);
  dummy.value = text;
  dummy.select();
  document.execCommand('copy');
  document.body.removeChild(dummy);
  
  var tooltip = document.getElementById(id + '-tooltip');
  tooltip.innerHTML = 'Copied!';
}

function reset_tooltip(id) {
  var tooltip = document.getElementById(id);
  tooltip.innerHTML = 'Copy link';
}
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script>
  $(document).ready(function () {
    var element_label= $("label[for *= 'tufte-sn-']");
    var count = $(element_label).length;
    $(element_label).each(function( index ) {
      //console.log( ++index + ": " + $( this ).text() );
      $(this).attr('for','tufte-sn-'+ ++index);
      $(this).text(index);
    });
  });
  $(document).ready(function () {
    var element_input= $("input[id *= 'tufte-sn-']");
    var count = $(element_input).length;
    $(element_input).each(function( index ) {
      //console.log( ++index + ": " + $( this ).text() );
      $(this).attr('id','tufte-sn-'+ ++index);
    }); 
  });
  $(document).ready(function () {
    var element_span= $("span[class *= 'sidenote-number']");
    var count = $(element_span).length;
    $(element_span).each(function( index ) {
      //console.log( ++index + ": " + $( this ).text() );
      $(this).text(++index);
    }); 
  });
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }

code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Educated Guess<p><p class="author">David Ubilava</p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BE; Chapters</a>
<div class="dropdown-content">
<a href="index.html" id="toc-an-intuitive-guide-to-forecasting-with-time-series-models-using-r">An Intuitive Guide to Forecasting With Time Series Models Using R</a>
<a href="forecasting-with-time-series-models.html" id="toc-forecasting-with-time-series-models">Forecasting With Time Series Models</a>
<a href="introduction-to-forecasting.html" id="toc-introduction-to-forecasting"><span class="toc-section-number">1</span> – Introduction to Forecasting</a>
<a href="features-of-time-series-data.html" id="toc-features-of-time-series-data"><span class="toc-section-number">2</span> – Features of Time Series Data</a>
<a href="forecasting-methods-and-routines.html" id="toc-forecasting-methods-and-routines"><span class="toc-section-number">3</span> – Forecasting Methods and Routines</a>
<a href="trends.html" id="toc-trends"><span class="toc-section-number">4</span> – Trends</a>
<a href="seasonality.html" id="toc-seasonality"><span class="toc-section-number">5</span> – Seasonality</a>
<a href="autoregression.html" id="toc-autoregression"><span class="toc-section-number">6</span> – Autoregression</a>
<a href="vector-autoregression.html" id="toc-vector-autoregression"><span class="toc-section-number">7</span> – Vector Autoregression</a>
<a href="threshold-autoregression.html" id="toc-threshold-autoregression"><span class="toc-section-number">8</span> – Threshold Autoregression</a>
<a href="forecast-evaluation.html" id="toc-forecast-evaluation"><span class="toc-section-number">9</span> – Forecast Evaluation</a>
<a id="active-page" href="forecast-combination.html" id="toc-forecast-combination"><span class="toc-section-number">10</span> – Forecast Combination</a><ul class="toc-sections">
<li class="toc"><a href="#benefits-of-forecast-combination"> Benefits of Forecast Combination</a></li>
<li class="toc"><a href="#optimal-weights-for-forecast-combination"> Optimal Weights for Forecast Combination</a></li>
<li class="toc"><a href="#forecast-encompassing"> Forecast Encompassing</a></li>
</ul>
<a href="forecasting-using-r.html" id="toc-forecasting-using-r">Forecasting Using R</a>
<a href="tutorial-1-introduction-to-r.html" id="toc-tutorial-1-introduction-to-r">Tutorial 1: Introduction to R</a>
<a href="tutorial-2-data-management-and-visualisation.html" id="toc-tutorial-2-data-management-and-visualisation">Tutorial 2: Data Management and Visualisation</a>
<a href="tutorial-3-forecasting-methods-and-routines.html" id="toc-tutorial-3-forecasting-methods-and-routines">Tutorial 3: Forecasting Methods and Routines</a>
<a href="tutorial-4-trends.html" id="toc-tutorial-4-trends">Tutorial 4: Trends</a>
<a href="tutorial-5-seasonality.html" id="toc-tutorial-5-seasonality">Tutorial 5: Seasonality</a>
<a href="tutorial-6-autoregression.html" id="toc-tutorial-6-autoregression">Tutorial 6: Autoregression</a>
<a href="tutorial-8-vector-autoregression.html" id="toc-tutorial-8-vector-autoregression">Tutorial 8: Vector Autoregression</a>
<a href="tutorial-9-threshold-autoregression.html" id="toc-tutorial-9-threshold-autoregression">Tutorial 9: Threshold Autoregression</a>
<a href="tutorial-10-forecast-evaluation.html" id="toc-tutorial-10-forecast-evaluation">Tutorial 10: Forecast Evaluation</a>
<a href="tutorial-11-forecast-combination.html" id="toc-tutorial-11-forecast-combination">Tutorial 11: Forecast Combination</a>
<a href="references.html" id="toc-references">References</a>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="forecast-combination" class="section level1" number="10">
<h1>
<span class="header-section-number">Chapter 10</span> – Forecast Combination</h1>
<p><img src="art/combination.png"></p>
<div id="benefits-of-forecast-combination" class="section level2" number="10.1">
<h2>
<span class="header-section-number">10.1</span> Benefits of Forecast Combination<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('benefits-of-forecast-combination')" onmouseout="reset_tooltip('benefits-of-forecast-combination-tooltip')"><span class="tooltiptext" id="benefits-of-forecast-combination-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p><span class="newthought">Every model yields forecasts</span> that are inaccurate in their own way. Taken together, two or more models can each contribute to an accurate forecast, on average. As the joke goes: a mathematician, a physicist, and a statistician went hunting. They stumbled upon a deer. The mathematician took a shot first but missed the target to the left by a metre. The physicist gave a shot next and missed the mark to the right by a metre. Having observed this, the statistician exclaimed: “We got it!”</p>
<p>The joke works because the first two scientists missed the target by the same distance and in an opposite direction. Had the mathematician, instead, missed the target by a few metres, or had the physicist, like the mathematician, missed the target to the right, the statistician would have been less excited about the expected outcome.</p>
<p>In accord with this analogy, the strategy of combining forecast to achieve a superior accuracy will best work if the models generate different enough forecasts with relatively similar expected loss functions.</p>
<p>Intuitively, a combined forecast aggregates more information or more ways of processing the information.</p>
<p>Practically, a method of forecast combination is akin to managing portfolio risk.</p>
</div>
<div id="optimal-weights-for-forecast-combination" class="section level2" number="10.2">
<h2>
<span class="header-section-number">10.2</span> Optimal Weights for Forecast Combination<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('optimal-weights-for-forecast-combination')" onmouseout="reset_tooltip('optimal-weights-for-forecast-combination-tooltip')"><span class="tooltiptext" id="optimal-weights-for-forecast-combination-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Forecast combination implies mixing the forecasts from different models with some proportions. In other words, a combined forecast is a weighted sum of the individual forecasts. The weights need to be selected in a way that maximizes the combined forecast accuracy, i.e., minimizes the combined forecast loss.</p>
<p>Consider two forecasting methods (or models), <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, each respectively yielding one-step-ahead forecasts <span class="math inline">\(y_{a,t+1|t}\)</span> and <span class="math inline">\(y_{b,t+1|t}\)</span>, and the associated forecast errors <span class="math inline">\(e_{a,t+1} = y_{t+1}-y_{a,t+1|t}\)</span> and <span class="math inline">\(e_{b,t+1} = y_{t+1}-y_{b,t+1|t}\)</span>.</p>
<p>A combined forecast, <span class="math inline">\(y_{c,t+1|t}\)</span>, is the weighted sum of these two forecasts: <span class="math display">\[y_{c,t+1|t} = (1-w)y_{a,t+1|t} + w y_{b,t+1|t},\]</span> where the usual assumption about the weights apply, i.e., <span class="math inline">\(0 \leq w \leq 1\)</span>.<label for="tufte-sn-17" class="margin-toggle sidenote-number">17</label><input type="checkbox" id="tufte-sn-17" class="margin-toggle"><span class="sidenote"><span class="sidenote-number">17</span> More broadly, if we have <span class="math inline">\(n\)</span> forecasts that we intend to combine, the associated weights, <span class="math inline">\(w_i:i=1,\ldots,n\)</span>, will each be bounded by zero and one, and together they will add up to one.</span></p>
<p>A combined forecast error is the weighted sum of the individual forecast errors: <span class="math display">\[e_{c,t+1} = (1-w)e_{a,t+1} + w e_{b,t+1}\]</span></p>
<p>The combined forecast error is, on average, zero (assuming that the individual forecasts are all unbiased): <span class="math display">\[E\left(e_{c,t+1}\right) = E\left[(1-w)e_{a,t+1} + w e_{b,t+1}\right] = 0\]</span></p>
<p>The variance of a combined forecast error is: <span class="math display">\[Var\left(e_{c,t+1}\right) = (1-w)^2 \sigma_a^2 + w^2  \sigma_b^2 + 2w(1-w)\sigma_{ab},\]</span> where <span class="math inline">\(\sigma_a\)</span> and <span class="math inline">\(\sigma_b\)</span> are the standard deviations of the forecast errors from models <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, and <span class="math inline">\(\sigma_{ab}=\rho_{ab}\sigma_a\sigma_b\)</span> is the covariance of the two forecast errors, which can also be expressed as a product of the correlation between the two forecast errors, <span class="math inline">\(\rho_{ab}\)</span>, and the standard deviations of each forecast error.</p>
<p>By taking the derivative of the combined forecast error variance, and equating it to zero, we obtain the optimal weight (which minimizes the combined forecast error variance): <span class="math display">\[w^* = \frac{\sigma_a^2-\sigma_{ab}}{\sigma_a^2+\sigma_b^2-2\sigma_{ab}}\]</span></p>
<p>A couple of features of interest become immediately apparent. First, when the two forecast errors are uncorrelated, the optimal weight assigned to the individual forecast is inversely proportional to the forecast error variance. Second, when the two forecast errors have the same variance, the optimal weight assigned to each individual forecast is equal to 0.5.</p>
<p>Substitute <span class="math inline">\(w^*\)</span> in place of <span class="math inline">\(w\)</span> in the formula for variance to obtain: <span class="math display">\[Var\left[e_{c,t+1}(w^*)\right] = \sigma_c^2(w^*) = \frac{\sigma_a^2\sigma_b^2(1-\rho^2)}{\sigma_a^2+\sigma_b^2-2\rho\sigma_a\sigma_b}\]</span></p>
<p>It can be shown that <span class="math inline">\(\sigma_c^2(w^*) \leq \min\{\sigma_a^2,\sigma_b^2\}\)</span>. That is to say that by combining forecasts we are not making things worse (so long as we use <em>optimal</em> weights).</p>
<p>In practice <span class="math inline">\(\sigma_a\)</span>, <span class="math inline">\(\sigma_b\)</span>, and <span class="math inline">\(sigma_{ab}\)</span> are unknown. So, we estimate these using a pseudo-forecasting routine. Specifically, the sample estimator of <span class="math inline">\(w^*\)</span> is: <span class="math display">\[\hat{w}^* = \frac{\hat{\sigma}_i^2-\hat{\sigma}_{ij}}{\hat{\sigma}_i^2+\hat{\sigma}_j^2-2\hat{\sigma}_{ij}},\]</span> where <span class="math inline">\(\hat{\sigma}_i^2 = \frac{1}{P-1}\sum_{t=R}^{R+P-1}{e_{a,t+1}^2}\)</span> and <span class="math inline">\(\hat{\sigma}_j^2 = \frac{1}{P-1}\sum_{t=R}^{R+P-1}{e_{b,t+1}^2}\)</span> are sample forecast error variances, and <span class="math inline">\(\hat{\sigma}_{ij}=\frac{1}{P-1}\sum_{t=R}^{R+P-1}{e_{a,t+1}e_{b,t+1}}\)</span> is a sample forecast error covariance, where <span class="math inline">\(P\)</span> denotes the number of out-of-sample forecasts.</p>
<p>The optimal weight has a straightforward interpretation in a regression setting. Consider the combined forecast equation as: <span class="math display">\[y_{t+1} = (1-w)y_{a,t+1|t} + w y_{b,t+1|t} + \varepsilon_{t+1},\]</span> where <span class="math inline">\(\varepsilon_{t+1}\equiv e_{c,t+1}\)</span>. We can re-arrange the equation so that: <span class="math display">\[e_{a,t+1} = w (y_{b,t+1|t}-y_{a,t+1|t}) + \varepsilon_{t+1},\]</span> where <span class="math inline">\(w\)</span> is obtained by estimating a linear regression with an intercept restricted to zero.</p>
<p>Alternatively, we can estimate an unconstrained variant of the combined forecast equation: <span class="math display">\[y_{t+1} = \alpha+\beta_a y_{a,t+1|t} + \beta_b y_{b,t+1|t} + \varepsilon_{t+1},\]</span> which relaxes the assumption that the forecasts are unbiased, as well as that the weights need to add up to one. Indeed, this unconstrained variant for forecast combination allows for the possibility of negative weights.</p>
</div>
<div id="forecast-encompassing" class="section level2" number="10.3">
<h2>
<span class="header-section-number">10.3</span> Forecast Encompassing<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('forecast-encompassing')" onmouseout="reset_tooltip('forecast-encompassing-tooltip')"><span class="tooltiptext" id="forecast-encompassing-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>A special case of forecast combination is when <span class="math inline">\(w=0\)</span>. Such an outcome (of the optimal weights) is known as forecast encompassing.</p>
<p>It is said that <span class="math inline">\(y_{a,t+1|t}\)</span> encompasses <span class="math inline">\(y_{b,t+1|t}\)</span>, when given that the former is available, the latter provides no additional useful information.</p>
<p>This is equivalent of testing the null hypothesis of <span class="math inline">\(w=0\)</span> in the combined forecast error equation, which, after rearranging terms, yields the following regression: <span class="math display">\[e_{a,t+1} = w\left(e_{a,t+1}-e_{b,t+1}\right)+\varepsilon_{t+1},\;~~t=R,\ldots,R+P-1\]</span> where <span class="math inline">\(\varepsilon_{t+1}\equiv e_{c,t+1}\)</span>, and where <span class="math inline">\(R\)</span> is the size of the (first) estimation window, and <span class="math inline">\(P\)</span> is the number of out-of-sample forecasts generated.</p>
<p>We can test for the forecast encompassing by regressing the realized value on individual forecasts: <span class="math display">\[y_{t+1} = \alpha + \beta_1 y_{a,t+1|t} + \beta_2 y_{b,t+1|t} + \varepsilon_{t+1},\]</span> and testing the null hypothesis that <span class="math inline">\(\beta_2=0\)</span>, given that <span class="math inline">\(\beta_1=1\)</span>.</p>

</div>
</div>
<p style="text-align: center;">
<a href="forecast-evaluation.html"><button class="btn btn-default">Previous</button></a>
<a href="forecasting-using-r.html"><button class="btn btn-default">Next</button></a>
</p>
<p class="build-date">Page built: 
2022-11-30
 using 
R version 4.1.2 (2021-11-01)
</p>
</div>
</div>



</body>
</html>
