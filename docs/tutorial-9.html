<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Tutorial 9 | Introduction to Time Series Modeling and Forecasting</title>
  <meta name="description" content="Tutorial 9 | Introduction to Time Series Modeling and Forecasting" />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Tutorial 9 | Introduction to Time Series Modeling and Forecasting" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Tutorial 9 | Introduction to Time Series Modeling and Forecasting" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Tutorial 9 | Introduction to Time Series Modeling and Forecasting" />
  
  <meta name="twitter:description" content="Tutorial 9 | Introduction to Time Series Modeling and Forecasting" />
  

<meta name="author" content="David Ubilava" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tutorial-8.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Time Series Modeling and Forecasting</a></li>

<li class="divider"></li>
<li><a href="index.html#foreword">Foreword<span></span></a></li>
<li><a href="preliminaries.html#preliminaries">Preliminaries<span></span></a></li>
<li class="chapter" data-level="1" data-path="introduction-to-forecasting.html"><a href="introduction-to-forecasting.html"><i class="fa fa-check"></i><b>1</b> Introduction to Forecasting<span></span></a></li>
<li class="chapter" data-level="2" data-path="stochastic-process-and-time-series.html"><a href="stochastic-process-and-time-series.html"><i class="fa fa-check"></i><b>2</b> Stochastic Process and Time Series<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="stochastic-process-and-time-series.html"><a href="stochastic-process-and-time-series.html#stationarity"><i class="fa fa-check"></i><b>2.1</b> Stationarity<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="stochastic-process-and-time-series.html"><a href="stochastic-process-and-time-series.html#serial-dependence"><i class="fa fa-check"></i><b>2.2</b> Serial Dependence<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="stochastic-process-and-time-series.html"><a href="stochastic-process-and-time-series.html#transformations"><i class="fa fa-check"></i><b>2.3</b> Transformations<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="forecasting-methods-and-routines.html"><a href="forecasting-methods-and-routines.html"><i class="fa fa-check"></i><b>3</b> Forecasting Methods and Routines<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="forecasting-methods-and-routines.html"><a href="forecasting-methods-and-routines.html#optimal-forecast"><i class="fa fa-check"></i><b>3.1</b> Optimal Forecast<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="forecasting-methods-and-routines.html"><a href="forecasting-methods-and-routines.html#measuring-forecast-accuracy"><i class="fa fa-check"></i><b>3.2</b> Measuring Forecast Accuracy<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="forecasting-methods-and-routines.html"><a href="forecasting-methods-and-routines.html#evaluating-time-series-forecasts"><i class="fa fa-check"></i><b>3.3</b> Evaluating Time Series Forecasts<span></span></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="forecasting-methods-and-routines.html"><a href="forecasting-methods-and-routines.html#unbiasedness"><i class="fa fa-check"></i><b>3.3.1</b> Unbiasedness<span></span></a></li>
<li class="chapter" data-level="3.3.2" data-path="forecasting-methods-and-routines.html"><a href="forecasting-methods-and-routines.html#efficiency"><i class="fa fa-check"></i><b>3.3.2</b> Efficiency<span></span></a></li>
<li class="chapter" data-level="3.3.3" data-path="forecasting-methods-and-routines.html"><a href="forecasting-methods-and-routines.html#no-autocorrelation"><i class="fa fa-check"></i><b>3.3.3</b> No Autocorrelation<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="deterministic-time-series-models.html#deterministic-time-series-models">Deterministic Time Series Models<span></span></a></li>
<li class="chapter" data-level="4" data-path="trends.html"><a href="trends.html"><i class="fa fa-check"></i><b>4</b> Trends<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="trends.html"><a href="trends.html#spurious-relationship"><i class="fa fa-check"></i><b>4.1</b> Spurious Relationship<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="trends.html"><a href="trends.html#modeling"><i class="fa fa-check"></i><b>4.2</b> Modeling<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="trends.html"><a href="trends.html#forecasting"><i class="fa fa-check"></i><b>4.3</b> Forecasting<span></span></a></li>
</ul></li>
<li><a href="deterministic-time-series-models-1.html#deterministic-time-series-models-1">Deterministic Time Series Models<span></span></a></li>
<li class="chapter" data-level="5" data-path="seasonality.html"><a href="seasonality.html"><i class="fa fa-check"></i><b>5</b> Seasonality<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="seasonality.html"><a href="seasonality.html#modeling-1"><i class="fa fa-check"></i><b>5.1</b> Modeling<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="seasonality.html"><a href="seasonality.html#forecasting-1"><i class="fa fa-check"></i><b>5.2</b> Forecasting<span></span></a></li>
</ul></li>
<li><a href="dynamic-time-series-models.html#dynamic-time-series-models">Dynamic Time Series Models<span></span></a></li>
<li class="chapter" data-level="6" data-path="linear-autoregression.html"><a href="linear-autoregression.html"><i class="fa fa-check"></i><b>6</b> Linear Autoregression<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="linear-autoregression.html"><a href="linear-autoregression.html#modeling-2"><i class="fa fa-check"></i><b>6.1</b> Modeling<span></span></a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="linear-autoregression.html"><a href="linear-autoregression.html#ar1"><i class="fa fa-check"></i><b>6.1.1</b> AR(1)<span></span></a></li>
<li class="chapter" data-level="6.1.2" data-path="linear-autoregression.html"><a href="linear-autoregression.html#ar2"><i class="fa fa-check"></i><b>6.1.2</b> AR(2)<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="linear-autoregression.html"><a href="linear-autoregression.html#forecasting-2"><i class="fa fa-check"></i><b>6.2</b> Forecasting<span></span></a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="linear-autoregression.html"><a href="linear-autoregression.html#one-step-ahead-forecast-from-ar1"><i class="fa fa-check"></i><b>6.2.1</b> One-step-ahead forecast from AR(1)<span></span></a></li>
<li class="chapter" data-level="6.2.2" data-path="linear-autoregression.html"><a href="linear-autoregression.html#two-step-ahead-forecast-from-ar1"><i class="fa fa-check"></i><b>6.2.2</b> Two-step-ahead forecast from AR(1)<span></span></a></li>
<li class="chapter" data-level="6.2.3" data-path="linear-autoregression.html"><a href="linear-autoregression.html#h-step-ahead-forecast-from-ar1"><i class="fa fa-check"></i><b>6.2.3</b> h-step-ahead forecast from AR(1)<span></span></a></li>
<li class="chapter" data-level="6.2.4" data-path="linear-autoregression.html"><a href="linear-autoregression.html#one-step-ahead-forecast-from-ar2"><i class="fa fa-check"></i><b>6.2.4</b> One-step-ahead forecast from AR(2)<span></span></a></li>
<li class="chapter" data-level="6.2.5" data-path="linear-autoregression.html"><a href="linear-autoregression.html#two-step-ahead-forecast-from-ar2"><i class="fa fa-check"></i><b>6.2.5</b> Two-step-ahead forecast from AR(2)<span></span></a></li>
<li class="chapter" data-level="6.2.6" data-path="linear-autoregression.html"><a href="linear-autoregression.html#one-step-ahead-forecast-from-ar2-1"><i class="fa fa-check"></i><b>6.2.6</b> One-step-ahead forecast from AR(2)<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="vector-autoregression.html"><a href="vector-autoregression.html"><i class="fa fa-check"></i><b>7</b> Vector Autoregression<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="vector-autoregression.html"><a href="vector-autoregression.html#modeling-3"><i class="fa fa-check"></i><b>7.1</b> Modeling<span></span></a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="vector-autoregression.html"><a href="vector-autoregression.html#in-sample-granger-causality"><i class="fa fa-check"></i><b>7.1.1</b> In-Sample Granger Causality<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="vector-autoregression.html"><a href="vector-autoregression.html#forecasting-3"><i class="fa fa-check"></i><b>7.2</b> Forecasting<span></span></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="vector-autoregression.html"><a href="vector-autoregression.html#one-step-ahead-forecast-from-bivariate-var1"><i class="fa fa-check"></i><b>7.2.1</b> One-step-ahead forecast from bivariate VAR(1)<span></span></a></li>
<li class="chapter" data-level="7.2.2" data-path="vector-autoregression.html"><a href="vector-autoregression.html#two-step-ahead-forecast-from-bivariate-var1"><i class="fa fa-check"></i><b>7.2.2</b> Two-step-ahead forecast from bivariate VAR(1)<span></span></a></li>
<li class="chapter" data-level="7.2.3" data-path="vector-autoregression.html"><a href="vector-autoregression.html#out-of-sample-granger-causality"><i class="fa fa-check"></i><b>7.2.3</b> Out-of-Sample Granger Causality<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="threshold-autoregression.html"><a href="threshold-autoregression.html"><i class="fa fa-check"></i><b>8</b> Threshold Autoregression<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="threshold-autoregression.html"><a href="threshold-autoregression.html#nonlinear-models"><i class="fa fa-check"></i><b>8.1</b> Nonlinear Models<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="threshold-autoregression.html"><a href="threshold-autoregression.html#modeling-4"><i class="fa fa-check"></i><b>8.2</b> Modeling<span></span></a></li>
<li class="chapter" data-level="8.3" data-path="threshold-autoregression.html"><a href="threshold-autoregression.html#forecasting-4"><i class="fa fa-check"></i><b>8.3</b> Forecasting<span></span></a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="threshold-autoregression.html"><a href="threshold-autoregression.html#skeleton-extrapolation"><i class="fa fa-check"></i><b>8.3.1</b> Skeleton Extrapolation<span></span></a></li>
<li class="chapter" data-level="8.3.2" data-path="threshold-autoregression.html"><a href="threshold-autoregression.html#analytical-method"><i class="fa fa-check"></i><b>8.3.2</b> Analytical Method<span></span></a></li>
<li class="chapter" data-level="8.3.3" data-path="threshold-autoregression.html"><a href="threshold-autoregression.html#numerical-method-bootstrap-resampling"><i class="fa fa-check"></i><b>8.3.3</b> Numerical Method: Bootstrap Resampling<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="forecast-assessment.html#forecast-assessment">Forecast Assessment<span></span></a></li>
<li class="chapter" data-level="9" data-path="forecast-evaluation.html"><a href="forecast-evaluation.html"><i class="fa fa-check"></i><b>9</b> Forecast Evaluation<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="forecast-evaluation.html"><a href="forecast-evaluation.html#the-need-for-the-forecast-evaluation"><i class="fa fa-check"></i><b>9.1</b> The Need for the Forecast Evaluation<span></span></a></li>
<li class="chapter" data-level="9.2" data-path="forecast-evaluation.html"><a href="forecast-evaluation.html#relative-forecast-accuracy-tests"><i class="fa fa-check"></i><b>9.2</b> Relative Forecast Accuracy Tests<span></span></a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="forecast-evaluation.html"><a href="forecast-evaluation.html#the-morgan-granger-newbold-test"><i class="fa fa-check"></i><b>9.2.1</b> The Morgan-Granger-Newbold Test<span></span></a></li>
<li class="chapter" data-level="9.2.2" data-path="forecast-evaluation.html"><a href="forecast-evaluation.html#the-diebold-mariano-test"><i class="fa fa-check"></i><b>9.2.2</b> The Diebold-Mariano Test<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="forecast-combination.html"><a href="forecast-combination.html"><i class="fa fa-check"></i><b>10</b> Forecast Combination<span></span></a></li>
<li><a href="introduction-to-r.html#introduction-to-r">Introduction to R<span></span></a>
<ul>
<li><a href="introduction-to-r.html#data-management">Data Management<span></span></a></li>
<li><a href="introduction-to-r.html#data-visualisation">Data Visualisation<span></span></a></li>
<li><a href="introduction-to-r.html#regression-analysis">Regression Analysis<span></span></a></li>
</ul></li>
<li><a href="tutorial-1.html#tutorial-1">Tutorial 1<span></span></a></li>
<li><a href="tutorial-2.html#tutorial-2">Tutorial 2<span></span></a></li>
<li><a href="tutorial-3.html#tutorial-3">Tutorial 3<span></span></a></li>
<li><a href="tutorial-4.html#tutorial-4">Tutorial 4<span></span></a></li>
<li><a href="tutorial-5.html#tutorial-5">Tutorial 5<span></span></a></li>
<li><a href="tutorial-6.html#tutorial-6">Tutorial 6<span></span></a></li>
<li><a href="tutorial-7.html#tutorial-7">Tutorial 7<span></span></a></li>
<li><a href="tutorial-8.html#tutorial-8">Tutorial 8<span></span></a></li>
<li><a href="tutorial-9.html#tutorial-9">Tutorial 9<span></span></a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction to Time Series Modeling and Forecasting</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tutorial-9" class="section level1 unnumbered hasAnchor">
<h1>Tutorial 9<a href="tutorial-9.html#tutorial-9" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this tutorial, we will generate a time series, we will obtain multi-step-ahead forecasts using direct and iterated methods from autoregressive models using a rolling window procedure, and we will assess the accuracy of the forecast. We will then turn to interval forecasts, and we will assess their coverage accuracy. To run the code, the <code>data.table</code>, <code>ggplot2</code>, <code>lmtest</code>, and <code>sandwich</code> packages need to be installed and loaded.</p>
<p>Let’s generate a time series that follow an AR(2) process as follows:
<span class="math display">\[y_t = 0.01t+0.6y_{t-1}+0.2y_{t-2}+\varepsilon_t\]</span>
where <span class="math inline">\(e_{t} \sim N(0,1)\)</span>.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="tutorial-9.html#cb176-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">240</span></span>
<span id="cb176-2"><a href="tutorial-9.html#cb176-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-3"><a href="tutorial-9.html#cb176-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9</span>)</span>
<span id="cb176-4"><a href="tutorial-9.html#cb176-4" aria-hidden="true" tabindex="-1"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb176-5"><a href="tutorial-9.html#cb176-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-6"><a href="tutorial-9.html#cb176-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>,n)</span>
<span id="cb176-7"><a href="tutorial-9.html#cb176-7" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fl">0.01</span><span class="sc">+</span>e[<span class="dv">1</span>]</span>
<span id="cb176-8"><a href="tutorial-9.html#cb176-8" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fl">0.02+0.6</span><span class="sc">*</span>y[<span class="dv">1</span>]<span class="sc">+</span>e[<span class="dv">2</span>]</span>
<span id="cb176-9"><a href="tutorial-9.html#cb176-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span>n){</span>
<span id="cb176-10"><a href="tutorial-9.html#cb176-10" aria-hidden="true" tabindex="-1"></a>  y[i] <span class="ot">&lt;-</span> <span class="fl">0.01</span><span class="sc">*</span>i<span class="fl">+0.6</span><span class="sc">*</span>y[i<span class="dv">-1</span>]<span class="sc">+</span><span class="fl">0.2</span><span class="sc">*</span>y[i<span class="dv">-2</span>]<span class="sc">+</span>e[i]</span>
<span id="cb176-11"><a href="tutorial-9.html#cb176-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Generate a vector of arbitrary dates (e.g., the monthly series beginning from January 2000), store these along with <span class="math inline">\(y\)</span> in a <strong>data.table</strong>, call it ‘dt,’ and plot the realized time series using the <strong>ggplot</strong> function.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="tutorial-9.html#cb177-1" aria-hidden="true" tabindex="-1"></a>date <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">&quot;2000-01-01&quot;</span>),<span class="at">by=</span><span class="st">&quot;month&quot;</span>,<span class="at">along.with=</span>y)</span>
<span id="cb177-2"><a href="tutorial-9.html#cb177-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-3"><a href="tutorial-9.html#cb177-3" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(date,y)</span>
<span id="cb177-4"><a href="tutorial-9.html#cb177-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-5"><a href="tutorial-9.html#cb177-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dt,<span class="fu">aes</span>(<span class="at">x=</span>date,<span class="at">y=</span>y))<span class="sc">+</span></span>
<span id="cb177-6"><a href="tutorial-9.html#cb177-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb177-7"><a href="tutorial-9.html#cb177-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Year&quot;</span>,<span class="at">y=</span><span class="st">&quot;Series&quot;</span>)<span class="sc">+</span></span>
<span id="cb177-8"><a href="tutorial-9.html#cb177-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="forecasting_files/figure-html/unnamed-chunk-102-1.png" width="672" /></p>
<p>Suppose we believe the series follow either the AR(1) or the AR(2) process, and that we want to compare iterated multi-step forecasts obtained from these models to direct multi-step forecasts. In what follows, we will generate twelve-step-ahead point forecasts from these two methods for the considered two models using the rolling window scheme, where the first rolling window ranges from period 1 to period 180. In obtaining the iterated multi-step forecasts, for each rolling window, we will generate a sequence of one-to-twelve-step-ahead forecasts, but only retain the twelve-step-ahead forecasts.</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="tutorial-9.html#cb178-1" aria-hidden="true" tabindex="-1"></a>h <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb178-2"><a href="tutorial-9.html#cb178-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-3"><a href="tutorial-9.html#cb178-3" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> dt[,.(date,y,<span class="at">y1=</span><span class="fu">shift</span>(y,<span class="dv">1</span>),<span class="at">y2=</span><span class="fu">shift</span>(y,<span class="dv">2</span>),<span class="at">y12=</span><span class="fu">shift</span>(y,h),<span class="at">y13=</span><span class="fu">shift</span>(y,h<span class="sc">+</span><span class="dv">1</span>))]</span>
<span id="cb178-4"><a href="tutorial-9.html#cb178-4" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> dt[<span class="fu">complete.cases</span>(dt)]</span>
<span id="cb178-5"><a href="tutorial-9.html#cb178-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-6"><a href="tutorial-9.html#cb178-6" aria-hidden="true" tabindex="-1"></a>dt[,<span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="at">a1i=</span><span class="fu">as.numeric</span>(<span class="cn">NA</span>),<span class="at">a1d=</span><span class="fu">as.numeric</span>(<span class="cn">NA</span>),<span class="at">a2i=</span><span class="fu">as.numeric</span>(<span class="cn">NA</span>),<span class="at">a2d=</span><span class="fu">as.numeric</span>(<span class="cn">NA</span>))]</span>
<span id="cb178-7"><a href="tutorial-9.html#cb178-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-8"><a href="tutorial-9.html#cb178-8" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">180</span></span>
<span id="cb178-9"><a href="tutorial-9.html#cb178-9" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">nrow</span>(dt)<span class="sc">-</span>R<span class="sc">-</span>h<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb178-10"><a href="tutorial-9.html#cb178-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-11"><a href="tutorial-9.html#cb178-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>P){</span>
<span id="cb178-12"><a href="tutorial-9.html#cb178-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb178-13"><a href="tutorial-9.html#cb178-13" aria-hidden="true" tabindex="-1"></a>  <span class="do">### iterated multi-step method</span></span>
<span id="cb178-14"><a href="tutorial-9.html#cb178-14" aria-hidden="true" tabindex="-1"></a>  a1i <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>y1,<span class="at">data=</span>dt[i<span class="sc">:</span>(R<span class="sc">+</span>i<span class="dv">-1</span>)])</span>
<span id="cb178-15"><a href="tutorial-9.html#cb178-15" aria-hidden="true" tabindex="-1"></a>  a2i <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>y1<span class="sc">+</span>y2,<span class="at">data=</span>dt[i<span class="sc">:</span>(R<span class="sc">+</span>i<span class="dv">-1</span>)])</span>
<span id="cb178-16"><a href="tutorial-9.html#cb178-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb178-17"><a href="tutorial-9.html#cb178-17" aria-hidden="true" tabindex="-1"></a>  iter_dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">hor=</span><span class="dv">1</span><span class="sc">:</span>h,<span class="at">a1=</span><span class="fu">as.numeric</span>(<span class="cn">NA</span>),<span class="at">a2=</span><span class="fu">as.numeric</span>(<span class="cn">NA</span>))</span>
<span id="cb178-18"><a href="tutorial-9.html#cb178-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb178-19"><a href="tutorial-9.html#cb178-19" aria-hidden="true" tabindex="-1"></a>  <span class="do">## AR(1)</span></span>
<span id="cb178-20"><a href="tutorial-9.html#cb178-20" aria-hidden="true" tabindex="-1"></a>  iter_dt<span class="sc">$</span>a1[<span class="dv">1</span>] <span class="ot">&lt;-</span> a1i<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span>a1i<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>dt[R<span class="sc">+</span>i<span class="dv">-1</span>]<span class="sc">$</span>y</span>
<span id="cb178-21"><a href="tutorial-9.html#cb178-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>h){</span>
<span id="cb178-22"><a href="tutorial-9.html#cb178-22" aria-hidden="true" tabindex="-1"></a>    iter_dt<span class="sc">$</span>a1[j] <span class="ot">&lt;-</span> a1i<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span>a1i<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>iter_dt<span class="sc">$</span>a1[j<span class="dv">-1</span>]</span>
<span id="cb178-23"><a href="tutorial-9.html#cb178-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb178-24"><a href="tutorial-9.html#cb178-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb178-25"><a href="tutorial-9.html#cb178-25" aria-hidden="true" tabindex="-1"></a>  <span class="do">## AR(2)</span></span>
<span id="cb178-26"><a href="tutorial-9.html#cb178-26" aria-hidden="true" tabindex="-1"></a>  iter_dt<span class="sc">$</span>a2[<span class="dv">1</span>] <span class="ot">&lt;-</span> a2i<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span>a2i<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>dt[R<span class="sc">+</span>i<span class="dv">-1</span>]<span class="sc">$</span>y<span class="sc">+</span>a2i<span class="sc">$</span>coefficients[<span class="dv">3</span>]<span class="sc">*</span>dt[R<span class="sc">+</span>i<span class="dv">-1</span>]<span class="sc">$</span>y1</span>
<span id="cb178-27"><a href="tutorial-9.html#cb178-27" aria-hidden="true" tabindex="-1"></a>  iter_dt<span class="sc">$</span>a2[<span class="dv">2</span>] <span class="ot">&lt;-</span> a2i<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span>a2i<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>iter_dt<span class="sc">$</span>a2[<span class="dv">1</span>]<span class="sc">+</span>a2i<span class="sc">$</span>coefficients[<span class="dv">3</span>]<span class="sc">*</span>dt[R<span class="sc">+</span>i<span class="dv">-1</span>]<span class="sc">$</span>y</span>
<span id="cb178-28"><a href="tutorial-9.html#cb178-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span>h){</span>
<span id="cb178-29"><a href="tutorial-9.html#cb178-29" aria-hidden="true" tabindex="-1"></a>    iter_dt<span class="sc">$</span>a2[j] <span class="ot">&lt;-</span> a2i<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span>a2i<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>iter_dt<span class="sc">$</span>a2[j<span class="dv">-1</span>]<span class="sc">+</span>a2i<span class="sc">$</span>coefficients[<span class="dv">3</span>]<span class="sc">*</span>iter_dt<span class="sc">$</span>a2[j<span class="dv">-2</span>]</span>
<span id="cb178-30"><a href="tutorial-9.html#cb178-30" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb178-31"><a href="tutorial-9.html#cb178-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-32"><a href="tutorial-9.html#cb178-32" aria-hidden="true" tabindex="-1"></a>  dt<span class="sc">$</span>a1i[R<span class="sc">+</span>i<span class="sc">+</span>h<span class="dv">-1</span>] <span class="ot">&lt;-</span> iter_dt<span class="sc">$</span>a1[h]</span>
<span id="cb178-33"><a href="tutorial-9.html#cb178-33" aria-hidden="true" tabindex="-1"></a>  dt<span class="sc">$</span>a2i[R<span class="sc">+</span>i<span class="sc">+</span>h<span class="dv">-1</span>] <span class="ot">&lt;-</span> iter_dt<span class="sc">$</span>a2[h]</span>
<span id="cb178-34"><a href="tutorial-9.html#cb178-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb178-35"><a href="tutorial-9.html#cb178-35" aria-hidden="true" tabindex="-1"></a>  <span class="do">### direct multi-step method</span></span>
<span id="cb178-36"><a href="tutorial-9.html#cb178-36" aria-hidden="true" tabindex="-1"></a>  a1d <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>y12,<span class="at">data=</span>dt[i<span class="sc">:</span>(R<span class="sc">+</span>i<span class="dv">-1</span>)])</span>
<span id="cb178-37"><a href="tutorial-9.html#cb178-37" aria-hidden="true" tabindex="-1"></a>  a2d <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>y12<span class="sc">+</span>y13,<span class="at">data=</span>dt[i<span class="sc">:</span>(R<span class="sc">+</span>i<span class="dv">-1</span>)])</span>
<span id="cb178-38"><a href="tutorial-9.html#cb178-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb178-39"><a href="tutorial-9.html#cb178-39" aria-hidden="true" tabindex="-1"></a>  dt<span class="sc">$</span>a1d[R<span class="sc">+</span>i<span class="sc">+</span>h<span class="dv">-1</span>] <span class="ot">&lt;-</span> a1d<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span>a1d<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>dt[R<span class="sc">+</span>i<span class="dv">-1</span>]<span class="sc">$</span>y</span>
<span id="cb178-40"><a href="tutorial-9.html#cb178-40" aria-hidden="true" tabindex="-1"></a>  dt<span class="sc">$</span>a2d[R<span class="sc">+</span>i<span class="sc">+</span>h<span class="dv">-1</span>] <span class="ot">&lt;-</span> a2d<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span>a2d<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>dt[R<span class="sc">+</span>i<span class="dv">-1</span>]<span class="sc">$</span>y<span class="sc">+</span>a2d<span class="sc">$</span>coefficients[<span class="dv">3</span>]<span class="sc">*</span>dt[R<span class="sc">+</span>i<span class="dv">-1</span>]<span class="sc">$</span>y1</span>
<span id="cb178-41"><a href="tutorial-9.html#cb178-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb178-42"><a href="tutorial-9.html#cb178-42" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can now test whether the forecasts of the iterated method ‘statistically significantly’ outperform those of the direct method?</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="tutorial-9.html#cb179-1" aria-hidden="true" tabindex="-1"></a>dt<span class="sc">$</span>a1i_e <span class="ot">&lt;-</span> dt<span class="sc">$</span>y<span class="sc">-</span>dt<span class="sc">$</span>a1i</span>
<span id="cb179-2"><a href="tutorial-9.html#cb179-2" aria-hidden="true" tabindex="-1"></a>dt<span class="sc">$</span>a2i_e <span class="ot">&lt;-</span> dt<span class="sc">$</span>y<span class="sc">-</span>dt<span class="sc">$</span>a2i</span>
<span id="cb179-3"><a href="tutorial-9.html#cb179-3" aria-hidden="true" tabindex="-1"></a>dt<span class="sc">$</span>a1d_e <span class="ot">&lt;-</span> dt<span class="sc">$</span>y<span class="sc">-</span>dt<span class="sc">$</span>a1d</span>
<span id="cb179-4"><a href="tutorial-9.html#cb179-4" aria-hidden="true" tabindex="-1"></a>dt<span class="sc">$</span>a2d_e <span class="ot">&lt;-</span> dt<span class="sc">$</span>y<span class="sc">-</span>dt<span class="sc">$</span>a2d</span>
<span id="cb179-5"><a href="tutorial-9.html#cb179-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-6"><a href="tutorial-9.html#cb179-6" aria-hidden="true" tabindex="-1"></a>dt<span class="sc">$</span>ld1 <span class="ot">&lt;-</span> dt<span class="sc">$</span>a1d_e<span class="sc">^</span><span class="dv">2</span><span class="sc">-</span>dt<span class="sc">$</span>a1i_e<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb179-7"><a href="tutorial-9.html#cb179-7" aria-hidden="true" tabindex="-1"></a>dt<span class="sc">$</span>ld2 <span class="ot">&lt;-</span> dt<span class="sc">$</span>a2d_e<span class="sc">^</span><span class="dv">2</span><span class="sc">-</span>dt<span class="sc">$</span>a2i_e<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb179-8"><a href="tutorial-9.html#cb179-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-9"><a href="tutorial-9.html#cb179-9" aria-hidden="true" tabindex="-1"></a>reg_ld1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ld1<span class="sc">~</span><span class="dv">1</span>,<span class="at">data=</span>dt)</span>
<span id="cb179-10"><a href="tutorial-9.html#cb179-10" aria-hidden="true" tabindex="-1"></a>reg_ld2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(ld2<span class="sc">~</span><span class="dv">1</span>,<span class="at">data=</span>dt)</span>
<span id="cb179-11"><a href="tutorial-9.html#cb179-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-12"><a href="tutorial-9.html#cb179-12" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(reg_ld1,<span class="at">vcov.=</span><span class="fu">vcovHAC</span>(reg_ld1))</span></code></pre></div>
<pre><code>## 
## t test of coefficients:
## 
##             Estimate Std. Error t value  Pr(&gt;|t|)    
## (Intercept)  -6.9266     1.7170 -4.0342 0.0002828 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="tutorial-9.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coeftest</span>(reg_ld2,<span class="at">vcov.=</span><span class="fu">vcovHAC</span>(reg_ld2))</span></code></pre></div>
<pre><code>## 
## t test of coefficients:
## 
##             Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept)  -3.1094     1.3271  -2.343  0.02494 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Obtain interval forecasts for horizon 12 using the direct method for an AR(1) model and a linear trend model; plot these interval forecasts along with the observed series.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="tutorial-9.html#cb183-1" aria-hidden="true" tabindex="-1"></a>dt<span class="sc">$</span>trend <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dt))</span>
<span id="cb183-2"><a href="tutorial-9.html#cb183-2" aria-hidden="true" tabindex="-1"></a>dt[,<span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="at">a1dl=</span><span class="fu">as.numeric</span>(<span class="cn">NA</span>),<span class="at">a1du=</span><span class="fu">as.numeric</span>(<span class="cn">NA</span>),<span class="at">trdl=</span><span class="fu">as.numeric</span>(<span class="cn">NA</span>),<span class="at">trdu=</span><span class="fu">as.numeric</span>(<span class="cn">NA</span>))]</span>
<span id="cb183-3"><a href="tutorial-9.html#cb183-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-4"><a href="tutorial-9.html#cb183-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>P){</span>
<span id="cb183-5"><a href="tutorial-9.html#cb183-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb183-6"><a href="tutorial-9.html#cb183-6" aria-hidden="true" tabindex="-1"></a>  a1d <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>y12,<span class="at">data=</span>dt[i<span class="sc">:</span>(R<span class="sc">+</span>i<span class="dv">-1</span>)])</span>
<span id="cb183-7"><a href="tutorial-9.html#cb183-7" aria-hidden="true" tabindex="-1"></a>  trd <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>trend,<span class="at">data=</span>dt[i<span class="sc">:</span>(R<span class="sc">+</span>i<span class="dv">-1</span>)])</span>
<span id="cb183-8"><a href="tutorial-9.html#cb183-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb183-9"><a href="tutorial-9.html#cb183-9" aria-hidden="true" tabindex="-1"></a>  a1d_pf <span class="ot">&lt;-</span> a1d<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span>a1d<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>dt[R<span class="sc">+</span>i<span class="dv">-1</span>]<span class="sc">$</span>y</span>
<span id="cb183-10"><a href="tutorial-9.html#cb183-10" aria-hidden="true" tabindex="-1"></a>  trd_pf <span class="ot">&lt;-</span> trd<span class="sc">$</span>coefficients[<span class="dv">1</span>]<span class="sc">+</span>trd<span class="sc">$</span>coefficients[<span class="dv">2</span>]<span class="sc">*</span>dt[R<span class="sc">+</span>i<span class="dv">-1</span><span class="sc">+</span>h]<span class="sc">$</span>trend</span>
<span id="cb183-11"><a href="tutorial-9.html#cb183-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb183-12"><a href="tutorial-9.html#cb183-12" aria-hidden="true" tabindex="-1"></a>  a1d_sd <span class="ot">&lt;-</span> <span class="fu">summary</span>(a1d)<span class="sc">$</span>sigma</span>
<span id="cb183-13"><a href="tutorial-9.html#cb183-13" aria-hidden="true" tabindex="-1"></a>  trd_sd <span class="ot">&lt;-</span> <span class="fu">summary</span>(trd)<span class="sc">$</span>sigma</span>
<span id="cb183-14"><a href="tutorial-9.html#cb183-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb183-15"><a href="tutorial-9.html#cb183-15" aria-hidden="true" tabindex="-1"></a>  dt<span class="sc">$</span>a1dl[R<span class="sc">+</span>i<span class="sc">+</span>h<span class="dv">-1</span>] <span class="ot">&lt;-</span> a1d_pf<span class="fl">-1.96</span><span class="sc">*</span>a1d_sd</span>
<span id="cb183-16"><a href="tutorial-9.html#cb183-16" aria-hidden="true" tabindex="-1"></a>  dt<span class="sc">$</span>a1du[R<span class="sc">+</span>i<span class="sc">+</span>h<span class="dv">-1</span>] <span class="ot">&lt;-</span> a1d_pf<span class="fl">+1.96</span><span class="sc">*</span>a1d_sd</span>
<span id="cb183-17"><a href="tutorial-9.html#cb183-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb183-18"><a href="tutorial-9.html#cb183-18" aria-hidden="true" tabindex="-1"></a>  dt<span class="sc">$</span>trdl[R<span class="sc">+</span>i<span class="sc">+</span>h<span class="dv">-1</span>] <span class="ot">&lt;-</span> trd_pf<span class="fl">-1.96</span><span class="sc">*</span>trd_sd</span>
<span id="cb183-19"><a href="tutorial-9.html#cb183-19" aria-hidden="true" tabindex="-1"></a>  dt<span class="sc">$</span>trdu[R<span class="sc">+</span>i<span class="sc">+</span>h<span class="dv">-1</span>] <span class="ot">&lt;-</span> trd_pf<span class="fl">+1.96</span><span class="sc">*</span>trd_sd</span>
<span id="cb183-20"><a href="tutorial-9.html#cb183-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb183-21"><a href="tutorial-9.html#cb183-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-22"><a href="tutorial-9.html#cb183-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dt,<span class="fu">aes</span>(<span class="at">x=</span>date,<span class="at">y=</span>y))<span class="sc">+</span></span>
<span id="cb183-23"><a href="tutorial-9.html#cb183-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="dv">1</span>,<span class="at">color=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb183-24"><a href="tutorial-9.html#cb183-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>a1dl),<span class="at">size=</span><span class="dv">1</span>,<span class="at">color=</span><span class="st">&quot;steelblue&quot;</span>,<span class="at">linetype=</span><span class="dv">5</span>,<span class="at">na.rm=</span>T)<span class="sc">+</span></span>
<span id="cb183-25"><a href="tutorial-9.html#cb183-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>a1du),<span class="at">size=</span><span class="dv">1</span>,<span class="at">color=</span><span class="st">&quot;steelblue&quot;</span>,<span class="at">linetype=</span><span class="dv">5</span>,<span class="at">na.rm=</span>T)<span class="sc">+</span></span>
<span id="cb183-26"><a href="tutorial-9.html#cb183-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>trdl),<span class="at">size=</span><span class="dv">1</span>,<span class="at">color=</span><span class="st">&quot;indianred&quot;</span>,<span class="at">linetype=</span><span class="dv">5</span>,<span class="at">na.rm=</span>T)<span class="sc">+</span></span>
<span id="cb183-27"><a href="tutorial-9.html#cb183-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>trdu),<span class="at">size=</span><span class="dv">1</span>,<span class="at">color=</span><span class="st">&quot;indianred&quot;</span>,<span class="at">linetype=</span><span class="dv">5</span>,<span class="at">na.rm=</span>T)<span class="sc">+</span></span>
<span id="cb183-28"><a href="tutorial-9.html#cb183-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="forecasting_files/figure-html/unnamed-chunk-105-1.png" width="672" /></p>
<p>Test the unconditional coverage of the interval forecasts from the considered two models.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="tutorial-9.html#cb184-1" aria-hidden="true" tabindex="-1"></a>dt[,<span class="st">`</span><span class="at">:=</span><span class="st">`</span>(<span class="at">i1=</span><span class="fu">ifelse</span>(y<span class="sc">&gt;=</span>a1dl <span class="sc">&amp;</span> y<span class="sc">&lt;=</span>a1du,<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">it=</span><span class="fu">ifelse</span>(y<span class="sc">&gt;=</span>trdl <span class="sc">&amp;</span> y<span class="sc">&lt;=</span>trdu,<span class="dv">1</span>,<span class="dv">0</span>))]</span>
<span id="cb184-2"><a href="tutorial-9.html#cb184-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-3"><a href="tutorial-9.html#cb184-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-4"><a href="tutorial-9.html#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="co"># AR(1)</span></span>
<span id="cb184-5"><a href="tutorial-9.html#cb184-5" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dt<span class="sc">$</span>i1,<span class="at">na.rm=</span>T)</span>
<span id="cb184-6"><a href="tutorial-9.html#cb184-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-7"><a href="tutorial-9.html#cb184-7" aria-hidden="true" tabindex="-1"></a>L10 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="fl">-.95</span>)<span class="sc">^</span>(P<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p1))<span class="sc">*</span>(.<span class="dv">95</span>)<span class="sc">^</span>(P<span class="sc">*</span>p1)</span>
<span id="cb184-8"><a href="tutorial-9.html#cb184-8" aria-hidden="true" tabindex="-1"></a>L11 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">^</span>(P<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p1))<span class="sc">*</span>(p1)<span class="sc">^</span>(P<span class="sc">*</span>p1)</span>
<span id="cb184-9"><a href="tutorial-9.html#cb184-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-10"><a href="tutorial-9.html#cb184-10" aria-hidden="true" tabindex="-1"></a>LR1 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(L10<span class="sc">/</span>L11)</span>
<span id="cb184-11"><a href="tutorial-9.html#cb184-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-12"><a href="tutorial-9.html#cb184-12" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(LR1,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail=</span>F)</span></code></pre></div>
<pre><code>## [1] 0.01027851</code></pre>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="tutorial-9.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AR(2)</span></span>
<span id="cb186-2"><a href="tutorial-9.html#cb186-2" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(dt<span class="sc">$</span>it,<span class="at">na.rm=</span>T)</span>
<span id="cb186-3"><a href="tutorial-9.html#cb186-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-4"><a href="tutorial-9.html#cb186-4" aria-hidden="true" tabindex="-1"></a>L20 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="fl">-.95</span>)<span class="sc">^</span>(P<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p2))<span class="sc">*</span>(.<span class="dv">95</span>)<span class="sc">^</span>(P<span class="sc">*</span>p2)</span>
<span id="cb186-5"><a href="tutorial-9.html#cb186-5" aria-hidden="true" tabindex="-1"></a>L21 <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span>p2)<span class="sc">^</span>(P<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p2))<span class="sc">*</span>(p2)<span class="sc">^</span>(P<span class="sc">*</span>p2)</span>
<span id="cb186-6"><a href="tutorial-9.html#cb186-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-7"><a href="tutorial-9.html#cb186-7" aria-hidden="true" tabindex="-1"></a>LR2 <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(L20<span class="sc">/</span>L21)</span>
<span id="cb186-8"><a href="tutorial-9.html#cb186-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-9"><a href="tutorial-9.html#cb186-9" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(LR2,<span class="at">df=</span><span class="dv">1</span>,<span class="at">lower.tail=</span>F)</span></code></pre></div>
<pre><code>## [1] 0.1441849</code></pre>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="tutorial-8.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["forecasting.pdf", "forecasting.epub", "forecasting.mobi"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
