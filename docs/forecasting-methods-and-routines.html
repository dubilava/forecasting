<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Chapter 3 Forecasting Methods and Routines | Introduction to Time Series Modeling and Forecasting with Applications in R" />
<meta property="og:type" content="book" />
<meta property="og:image" content="/forecasting-logo.png" />
<meta property="og:description" content="Chapter 3 Forecasting Methods and Routines | Introduction to Time Series Modeling and Forecasting with Applications in R" />


<meta name="author" content="David Ubilava" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="Chapter 3 Forecasting Methods and Routines | Introduction to Time Series Modeling and Forecasting with Applications in R">

<title>Chapter 3 Forecasting Methods and Routines | Introduction to Time Series Modeling and Forecasting with Applications in R</title>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css-0/msmb.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>
<script>
function copy_link(id) {
  var dummy = document.createElement('input'),
  text = window.location.href.split(/[?#]/)[0] + '#' + id;
  document.body.appendChild(dummy);
  dummy.value = text;
  dummy.select();
  document.execCommand('copy');
  document.body.removeChild(dummy);
  
  var tooltip = document.getElementById(id + '-tooltip');
  tooltip.innerHTML = 'Copied!';
}

function reset_tooltip(id) {
  var tooltip = document.getElementById(id);
  tooltip.innerHTML = 'Copy link';
}
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }

code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Introduction to Time Series Modeling and Forecasting with Applications in R<p><p class="author">David Ubilava</p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BE; Chapters</a>
<div class="dropdown-content">
<a href="index.html">Foreword</a>
<a href="introduction-to-forecasting.html"><span class="toc-section-number">1</span> Introduction to Forecasting</a>
<a href="features-of-time-series-data.html"><span class="toc-section-number">2</span> Features of Time Series Data</a>
<a id="active-page" href="forecasting-methods-and-routines.html"><span class="toc-section-number">3</span> Forecasting Methods and Routines</a><ul class="toc-sections">
<li class="toc"><a href="#optimal-forecast"> Optimal Forecast</a></li>
<li class="toc"><a href="#measuring-the-accuracy-of-forecasts"> Measuring the Accuracy of Forecasts</a></li>
<li class="toc"><a href="#evaluating-time-series-forecasts"> Evaluating Time Series Forecasts</a></li>
</ul>
<a href="trends-and-seasonality.html"><span class="toc-section-number">4</span> Trends and Seasonality</a>
<a href="autoregressive-models.html"><span class="toc-section-number">5</span> Autoregressive Models</a>
<a href="vector-autoregressive-models.html"><span class="toc-section-number">6</span> Vector Autoregressive Models</a>
<a href="dynamic-factor-models.html"><span class="toc-section-number">7</span> Dynamic Factor Models</a>
<a href="threshold-autoregressive-models.html"><span class="toc-section-number">8</span> Threshold Autoregressive Models</a>
<a href="forecast-evaluation.html"><span class="toc-section-number">9</span> Forecast Evaluation</a>
<a href="forecast-combination.html"><span class="toc-section-number">10</span> Forecast Combination</a>
<a href="tutorial-1-introduction-to-r.html">Tutorial 1: Introduction to R</a>
<a href="tutorial-2-data-management.html">Tutorial 2: Data Management</a>
<a href="tutorial-3-forecasting-methods-and-routines.html">Tutorial 3: Forecasting Methods and Routines</a>
<a href="tutorial-4-trends-and-seasonality.html">Tutorial 4: Trends and Seasonality</a>
<a href="tutorial-5-autoregressive-models.html">Tutorial 5: Autoregressive Models</a>
<a href="tutorial-6-vector-autoregressive-models.html">Tutorial 6: Vector Autoregressive Models</a>
<a href="tutorial-7-dynamic-factor-models.html">Tutorial 7: Dynamic Factor Models</a>
<a href="tutorial-8-threshold-autoregression.html">Tutorial 8: Threshold Autoregression</a>
<a href="tutorial-9-forecast-evaluation.html">Tutorial 9: Forecast Evaluation</a>
<a href="tutorial-10-forecast-combination.html">Tutorial 10: Forecast Combination</a>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="forecasting-methods-and-routines" class="section level1" number="3">
<h1>
<span class="header-section-number">Chapter 3</span> Forecasting Methods and Routines</h1>
<div id="optimal-forecast" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Optimal Forecast<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('optimal-forecast')" onmouseout="reset_tooltip('optimal-forecast-tooltip')"><span class="tooltiptext" id="optimal-forecast-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>A forecast is a random variable which has some distribution and, thus, moments. The simplest form of a forecast is a point forecast (usually a mean of the distribution, but can be a median or, indeed, any quantile).</p>
<p>A point forecast made in period <span class="math inline">\(t\)</span> for horizon <span class="math inline">\(h\)</span> can be denoted as <span class="math inline">\(y_{t+h|t}\)</span>; this is our ‘best guess,’ that is made in period <span class="math inline">\(t\)</span>, about the actual realization of the random variable in period <span class="math inline">\(t+h\)</span>, denoted by <span class="math inline">\(y_{t+h}\)</span>. The difference between the two is the forecast error. That is, <span class="math display">\[e_{t+h|t} = y_{t+h} - y_{t+h|t}\]</span></p>
<p>The more accurate is the forecast the smaller is the forecast error. And while on average the forecast error is zero (assuming the forecast is unbiased), the forecast error variance is non-zero, implying uncertainty surrounding a pont forecast. Thus, as uncertainty cannot be avoided, a forecaster is bound to commit forecast errors. The goal of the forecaster is to minimize the ‘cost’ associated with the forecast errors. This is achieved by minimizing the expected loss function.</p>
<p>A loss function, <span class="math inline">\(L(e_{t+h|t})\)</span>, can take many different forms, but is should satisfy the following properties:
<span class="math display">\[\begin{aligned}
        &amp; L(e_{t+h|t}) = 0,\;~~\forall\;e_{t+h|t} = 0 \\
        &amp; L(e_{t+h|t}) \geq 0,\;~~\forall\;e_{t+h|t} \neq 0 \\
        &amp; L(e_{t+h|t}^{(i)}) &gt; L(e_{t+h|t}^{(j)}),\;~~\forall\;|e_{t+h|t}^{(i)}| &gt; |e_{t+h|t}^{(j)}|
        \end{aligned}\]</span></p>
<p>Two commonly used symmetric loss functions are <em>absolute</em> and <em>quadratic</em> loss functions:
<span class="math display">\[\begin{aligned}
        &amp; L{(e_{t+h|t})} = |e_{t+h|t}|\;~~\text{(absolute loss function)} \\
        &amp; L{(e_{t+h|t})} = (e_{t+h|t})^2\;~~\text{(quadratic loss function)}
        \end{aligned}\]</span></p>
<p>The quadratic loss function is popular, partly because we typically select models based on ‘in-sample’ quadratic loss (i.e. by minimizing the sum of squared residuals).</p>
<p>Optimal forecast is the forecast that minimizes the expected loss:
<span class="math display">\[\min_{y_{t+h|t}} E\left[L\left(e_{t+h|t}\right)\right] = \min_{y_{t+h|t}} E\left[L\left(y_{t+h}-y_{t+h|t}\right)\right]\]</span>
where the expected loss is given by:
<span class="math display">\[E\left[L\left(y_{t+h}-y_{t+h|t}\right)\right]=\int L\left(y_{t+h}-y_{t+h|t}\right) f(y_{t+h}|\Omega_t)dy\]</span></p>
<p>We can assume that the conditional density is a normal density with mean <span class="math inline">\(\mu_{t+h} \equiv E(y_{t+h})\)</span>, and variance <span class="math inline">\(\sigma_{t+h}^2 \equiv Var(y_{t+h})\)</span>.</p>
<p>Under the assumption of the quadratic loss function:
<span class="math display">\[\begin{aligned}
        E\left[L(e_{t+h|t})\right] &amp; = E(e_{t+h|t}^2) = E(y_{t+h} - \hat{y}_{t+h|t})^2 \\
        &amp; = E(y_{t+h}^2)-2E(y_{t+h})\hat{y}_{t+h|t} + \hat{y}_{t+h|t}^2
        \end{aligned}\]</span></p>
<p>By solving the optimization problem it follows that: <span class="math display">\[\hat{y}_{t+h|t} = E(y_{t+h}) \equiv \mu_{t+h}\]</span></p>
<p>Thus, the optimal point forecast under the quadratic loss is the <em>mean</em> (for reference, the optimal point forecast under absolute loss is the <em>median</em>).</p>
</div>
<div id="measuring-the-accuracy-of-forecasts" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Measuring the Accuracy of Forecasts<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('measuring-the-accuracy-of-forecasts')" onmouseout="reset_tooltip('measuring-the-accuracy-of-forecasts-tooltip')"><span class="tooltiptext" id="measuring-the-accuracy-of-forecasts-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>Forecast accuracy should only be determined by considering how well a model performs on data not used in estimation. But to assess forecast accuracy we need access to the data, typically from future time periods, that was not used in estimation. This leads to the so-called ‘pseudo forecasting’ routine. This routine involves splitting the available data into two segments referred to as ‘in-sample’ and ‘out-of-sample.’ The in-sample segment of a series is also known as the ‘estimation set’ or the ‘training set.’ The out-of-sample segment of a series is also known as the ‘hold-out set’ or the ‘test set.’</p>
<p>Thus, we make the so-called ‘genuine’ forecasts using only the information from the estimation set, and assess the accuracy of these forecasts in an out-of-sample setting.</p>
<p>Because forecasting is often performed in a time series context, the estimation set typically predates the hold-out set. In non-dynamic settings such chronological ordering may not be necessary, however.</p>
<p>There are different forecasting schemes for updating the information set in the pseudo-forecasting routine. These are: <em>recursive</em>, <em>rolling</em>, and <em>fixed</em>.</p>
<ul>
<li>The recursive forecasting environment uses a sequence of expanding windows to update model estimates and the information set.</li>
<li>The rolling forecasting environment uses a sequence of rolling windows of the same size to update model estimates and the information set.</li>
<li>The fixed forecasting environment uses one fixed window for model estimates, and only updates the information set.</li>
</ul>
<p>The following animation illustrates the distinctive features of these three routines:</p>
<p><img src="forecasting_files/figure-html/routines-1.png" width="672"></p>
</div>
<div id="evaluating-time-series-forecasts" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Evaluating Time Series Forecasts<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('evaluating-time-series-forecasts')" onmouseout="reset_tooltip('evaluating-time-series-forecasts-tooltip')"><span class="tooltiptext" id="evaluating-time-series-forecasts-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>To evaluate forecasts of a time series, <span class="math inline">\(\{y_t\}\)</span>, with a total of <span class="math inline">\(T\)</span> observations, we divide the sample into two parts, the in-sample set with a total of <span class="math inline">\(R\)</span> observations, such that <span class="math inline">\(R &lt; T\)</span> (typically, <span class="math inline">\(R \approx 0.75T\)</span>), and the out-of-sample set.</p>
<p>For example, if we are interested in one-step-ahead forecast assessment, this way we will produce a sequence of forecasts: <span class="math inline">\(\{y_{R+1|R},y_{R+2|{R+1}},\ldots,y_{T|{T-1}}\}\)</span> for <span class="math inline">\(\{Y_{R+1},Y_{R+2},\ldots,Y_{T}\}\)</span>.</p>
<p>Forecast errors, <span class="math inline">\(e_{R+j} = y_{R+j} - y_{R+j|{R+j-1}}\)</span>, then can be computed for <span class="math inline">\(j = 1,\ldots,T-R\)</span>.</p>
<p>The most commonly applied accuracy measures are the mean absolute forecast error (MAFE) and the root mean squared forecast error (RMSFE):
<span class="math display">\[\begin{aligned}
\text{MAFE}  = &amp; \frac{1}{P}\sum_{i=1}^{P}|e_i|\\
\text{RMSFE} = &amp; \sqrt{\frac{1}{P}\sum_{i=1}^{P}e_i^2}
\end{aligned}\]</span>
where <span class="math inline">\(P\)</span> is the total number of out-of-sample forecasts. The lower is the accuracy measure (of choice), the better a given model performs in generating accurate forecasts. As noted earlier, ‘better’ does not mean ‘without errors.’</p>
<p>Forecast errors of a ‘good’ forecasting method will have the following properties:</p>
<ul>
<li>zero mean; otherwise, the forecasts are biased.</li>
<li>no correlation with the forecasts; otherwise, there is information left that should be used in computing forecasts.</li>
<li>no serial correlation among one-step-ahead forecast errors. Note that <span class="math inline">\(k\)</span>-step-ahead forecasts, for <span class="math inline">\(k&gt;1\)</span>, can be, and usually are, serially correlated.</li>
</ul>
<p>Any forecasting method that does not satisfy these properties has a potential to be improved.</p>
<div id="unbiasedness" class="section level3" number="3.3.1">
<h3>
<span class="header-section-number">3.3.1</span> Unbiasedness<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('unbiasedness')" onmouseout="reset_tooltip('unbiasedness-tooltip')"><span class="tooltiptext" id="unbiasedness-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>Testing <span class="math inline">\(E(e_{t+h|t})=0\)</span>. Set up a regression: <span class="math display">\[e_{t+h|t} = \alpha+\upsilon_{t+h} \hspace{.5in} t = R,\ldots,T-h,\]</span>
where <span class="math inline">\(R\)</span> is the estimation window size, <span class="math inline">\(T\)</span> is the sample size, and <span class="math inline">\(h\)</span> is the forecast horizon length. The null of zero-mean forecast error is equivalent of testing <span class="math inline">\(H_0: \alpha = 0\)</span> in the OLS setting. For <span class="math inline">\(h\)</span>-step-ahead forecast errors, when <span class="math inline">\(h&gt;1\)</span>, autocorrelation consistent standard errors should be used.</p>
</div>
<div id="efficiency" class="section level3" number="3.3.2">
<h3>
<span class="header-section-number">3.3.2</span> Efficiency<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('efficiency')" onmouseout="reset_tooltip('efficiency-tooltip')"><span class="tooltiptext" id="efficiency-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>Testing <span class="math inline">\(Cov(e_{t+h|t},y_{t+h|t})=0\)</span>. Set up a regression: <span class="math display">\[e_{t+h|t} = \alpha + \beta y_{t+h|t} + \upsilon_{t+h} \hspace{.5in} t = R,\ldots,T-h.\]</span> The null of forecast error independence of the information set is equivalent of testing <span class="math inline">\(H_0: \beta = 0\)</span> in the OLS setting. For <span class="math inline">\(h\)</span>-step-ahead forecast errors, when <span class="math inline">\(h&gt;1\)</span>, autocorrelation consistent standard errors should be used.</p>
</div>
<div id="no-autocorrelation" class="section level3" number="3.3.3">
<h3>
<span class="header-section-number">3.3.3</span> No Autocorrelation<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('no-autocorrelation')" onmouseout="reset_tooltip('no-autocorrelation-tooltip')"><span class="tooltiptext" id="no-autocorrelation-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>Testing <span class="math inline">\(Cov(e_{t+1|t},e_{t|t-1})=0\)</span>. Set up a regression: <span class="math display">\[e_{t+1|t} = \alpha + \gamma e_{t|t-1} + \upsilon_{t+1} \hspace{.5in} t = R+1,\ldots,T-1.\]</span> The null of no forecast error autocorrelation is equivalent of testing <span class="math inline">\(H_0: \gamma = 0\)</span> in the OLS setting.</p>

</div>
</div>
</div>
<p style="text-align: center;">
<a href="features-of-time-series-data.html"><button class="btn btn-default">Previous</button></a>
<a href="trends-and-seasonality.html"><button class="btn btn-default">Next</button></a>
</p>
<p class="build-date">Page built: 
2022-04-30
 using 
R version 4.1.2 (2021-11-01)
</p>
</div>
</div>



</body>
</html>
