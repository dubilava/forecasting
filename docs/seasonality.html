<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Chapter 5 – Seasonality | Educated Guess" />
<meta property="og:type" content="book" />
<meta property="og:image" content="/forecasting-logo.png" />
<meta property="og:description" content="Forecasting With Time Series Models Using R" />


<meta name="author" content="David Ubilava" />


<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="description" content="Forecasting With Time Series Models Using R">

<title>Chapter 5 – Seasonality | Educated Guess</title>

<link href="libs/tufte-css-2015.12.29/tufte.css" rel="stylesheet" />
<link href="libs/tufte-css-2015.12.29/envisioned.css" rel="stylesheet" />
<link href="libs/msmb-css-0/msmb.css" rel="stylesheet" />
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);

e.style.display = ((e.style.display!='none') ? 'none' : 'block');

if(f.classList.contains('fa-plus-square')) {
    f.classList.add('fa-minus-square')
    f.classList.remove('fa-plus-square')
} else {
    f.classList.add('fa-plus-square')
    f.classList.remove('fa-minus-square')
}

}
</script>
<script>
function copy_link(id) {
  var dummy = document.createElement('input'),
  text = window.location.href.split(/[?#]/)[0] + '#' + id;
  document.body.appendChild(dummy);
  dummy.value = text;
  dummy.select();
  document.execCommand('copy');
  document.body.removeChild(dummy);
  
  var tooltip = document.getElementById(id + '-tooltip');
  tooltip.innerHTML = 'Copied!';
}

function reset_tooltip(id) {
  var tooltip = document.getElementById(id);
  tooltip.innerHTML = 'Copy link';
}
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script>
  $(document).ready(function () {
    var element_label= $("label[for *= 'tufte-sn-']");
    var count = $(element_label).length;
    $(element_label).each(function( index ) {
      //console.log( ++index + ": " + $( this ).text() );
      $(this).attr('for','tufte-sn-'+ ++index);
      $(this).text(index);
    });
  });
  $(document).ready(function () {
    var element_input= $("input[id *= 'tufte-sn-']");
    var count = $(element_input).length;
    $(element_input).each(function( index ) {
      //console.log( ++index + ": " + $( this ).text() );
      $(this).attr('id','tufte-sn-'+ ++index);
    }); 
  });
  $(document).ready(function () {
    var element_span= $("span[class *= 'sidenote-number']");
    var count = $(element_span).length;
    $(element_span).each(function( index ) {
      //console.log( ++index + ": " + $( this ).text() );
      $(this).text(++index);
    }); 
  });
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }

code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>



<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul class="navbar">
<li class="msmb"><p class="title">Educated Guess<p><p class="author">David Ubilava</p>
<li class="dropdown" style="float:right">
<a href="javascript:void(0)" class="dropbtn">&#x25BE; Chapters</a>
<div class="dropdown-content">
<a href="index.html" id="toc-educated-guess-an-intuitive-guide-to-forecasting-with-time-series-models-using-r">Educated Guess: An Intuitive Guide to Forecasting With Time Series Models Using R</a>
<a href="forecasting-with-time-series-models.html" id="toc-forecasting-with-time-series-models">Forecasting With Time Series Models</a>
<a href="introduction-to-forecasting.html" id="toc-introduction-to-forecasting"><span class="toc-section-number">1</span> – Introduction to Forecasting</a>
<a href="features-of-time-series-data.html" id="toc-features-of-time-series-data"><span class="toc-section-number">2</span> – Features of Time Series Data</a>
<a href="forecasting-methods-and-routines.html" id="toc-forecasting-methods-and-routines"><span class="toc-section-number">3</span> – Forecasting Methods and Routines</a>
<a href="trends.html" id="toc-trends"><span class="toc-section-number">4</span> – Trends</a>
<a id="active-page" href="seasonality.html" id="toc-seasonality"><span class="toc-section-number">5</span> – Seasonality</a><ul class="toc-sections">
<li class="toc"><a href="#seasonal-fluctuations-in-the-data"> Seasonal Fluctuations in the Data</a></li>
<li class="toc"><a href="#modeling-1"> Modeling</a></li>
<li class="toc"><a href="#forecasting-1"> Forecasting</a></li>
</ul>
<a href="autoregression.html" id="toc-autoregression"><span class="toc-section-number">6</span> – Autoregression</a>
<a href="vector-autoregression.html" id="toc-vector-autoregression"><span class="toc-section-number">7</span> – Vector Autoregression</a>
<a href="threshold-autoregression.html" id="toc-threshold-autoregression"><span class="toc-section-number">8</span> – Threshold Autoregression</a>
<a href="forecast-evaluation.html" id="toc-forecast-evaluation"><span class="toc-section-number">9</span> – Forecast Evaluation</a>
<a href="forecast-combination.html" id="toc-forecast-combination"><span class="toc-section-number">10</span> – Forecast Combination</a>
<a href="forecasting-using-r.html" id="toc-forecasting-using-r">Forecasting Using R</a>
<a href="tutorial-1-introduction-to-r.html" id="toc-tutorial-1-introduction-to-r">Tutorial 1: Introduction to R</a>
<a href="tutorial-2-data-management-and-visualisation.html" id="toc-tutorial-2-data-management-and-visualisation">Tutorial 2: Data Management and Visualisation</a>
<a href="tutorial-3-forecasting-methods-and-routines.html" id="toc-tutorial-3-forecasting-methods-and-routines">Tutorial 3: Forecasting Methods and Routines</a>
<a href="tutorial-4-trends.html" id="toc-tutorial-4-trends">Tutorial 4: Trends</a>
<a href="tutorial-5-seasonality.html" id="toc-tutorial-5-seasonality">Tutorial 5: Seasonality</a>
<a href="tutorial-6-autoregression.html" id="toc-tutorial-6-autoregression">Tutorial 6: Autoregression</a>
<a href="tutorial-7-moving-average.html" id="toc-tutorial-7-moving-average">Tutorial 7: Moving Average</a>
<a href="tutorial-8-vector-autoregression.html" id="toc-tutorial-8-vector-autoregression">Tutorial 8: Vector Autoregression</a>
<a href="tutorial-9-threshold-autoregression.html" id="toc-tutorial-9-threshold-autoregression">Tutorial 9: Threshold Autoregression</a>
<a href="tutorial-10-forecast-evaluation.html" id="toc-tutorial-10-forecast-evaluation">Tutorial 10: Forecast Evaluation</a>
<a href="tutorial-10-forecast-combination.html" id="toc-tutorial-10-forecast-combination">Tutorial 10: Forecast Combination</a>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="seasonality" class="section level1" number="5">
<h1>
<span class="header-section-number">Chapter 5</span> – Seasonality</h1>
<p><img src="art/seasonality.png"></p>
<div id="seasonal-fluctuations-in-the-data" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> Seasonal Fluctuations in the Data<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('seasonal-fluctuations-in-the-data')" onmouseout="reset_tooltip('seasonal-fluctuations-in-the-data-tooltip')"><span class="tooltiptext" id="seasonal-fluctuations-in-the-data-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p><span class="newthought">Seasonality characterizes</span> some economic time series. Prices of agricultural commodities, for example, tend to have a seasonal pattern, owing to relative abundance of the commodity after harvest, and their gradual depletion as the year progresses. Energy sales also tend to have seasonal pattern, due to relatively high demand for energy during the winter (the need for heating) and summer (the need for cooling) months. Seasonality is a self-repeating pattern within a calendar year that arises from the links of economic outcomes to the calendar.</p>
<p>Modeling and forecasting seasonal time series, as it was the case with trending time series, is usually a straightforward exercise.</p>
</div>
<div id="modeling-1" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> Modeling<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('modeling-1')" onmouseout="reset_tooltip('modeling-1-tooltip')"><span class="tooltiptext" id="modeling-1-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>We typically model seasonality as a monthly or quarterly pattern, but it can also be modeled as a higher frequency pattern (e.g. weekly or daily).</p>
<p>One way to account for seasonality in the data is to “remove” it prior to the use of the series (i.e., work with a seasonally adjusted time series). Indeed, some economic time series are only/also available in a seasonally-adjusted form.</p>
<p>Otherwise, and perhaps more interestingly, we can incorporate the seasonal component into a regression setting.</p>
<div id="seasonal-dummy-variables" class="section level3" number="5.2.1">
<h3>
<span class="header-section-number">5.2.1</span> Seasonal dummy variables<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('seasonal-dummy-variables')" onmouseout="reset_tooltip('seasonal-dummy-variables-tooltip')"><span class="tooltiptext" id="seasonal-dummy-variables-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>A seasonal model, typically, is given by: <span class="math display">\[y_t = \sum_{i=1}^{s}\gamma_i d_{it} + \varepsilon_t,\]</span>
where <span class="math inline">\(s\)</span> denotes the frequency of the data, and <span class="math inline">\(d_{it}\)</span> takes the value of one repeatedly after every <span class="math inline">\(s\)</span> periods, and is zero in all other periods, so that <span class="math inline">\(\sum_{i} d_{it} = 1\)</span>, <span class="math inline">\(\forall t\)</span>. Each <span class="math inline">\(\gamma_i\)</span> is, in effect, an intercept of a given season.</p>
<p>Alternatively the seasonal model can be rewritten as: <span class="math display">\[y_t = \alpha + \sum_{i=1}^{s-1}\delta_i d_{it} + \varepsilon_t,\]</span> in which case <span class="math inline">\(\alpha\)</span> is an intercept of an omitted season, and <span class="math inline">\(\delta_i\)</span> represents a deviation from it during the <span class="math inline">\(i^{th}\)</span> season. This is a more typical form of a seasonal model.</p>
<p>Both variants of a seasonal model result in an identical fit and forecasts. Indeed, the two models are equivalent. Assuming the dummy variable associated with a season <span class="math inline">\(s\)</span>, <span class="math inline">\(d_{s}\)</span>, was dropped, <span class="math inline">\(\alpha=\gamma_s\)</span>, and <span class="math inline">\(\alpha+\delta_i=\gamma_i\;~\forall~i\ne s\)</span>.</p>
<p>Consider a monthly series of vehicle miles traveled in the United States (sourced from the online data portal of the Federal Reserve Bank of St. Louis) spanning the January 2003 – December 2015 period.</p>
<div class="figure">
<span style="display:block;" id="fig:miles"></span>
<p class="caption marginnote shownote">
Figure 5.1: Vehicle miles traveled in the U.S.
</p>
<img src="forecasting_files/figure-html/miles-1.png" alt="Vehicle miles traveled in the U.S." width="624">
</div>
<p>Seasonality is apparent in the series. We can approximate the seasonality using monthly dummy variables. Specifically, we can estimate the model parameters by regressing vehicle miles traveled, which we denote by <span class="math inline">\(y\)</span>, on intercept and 11 monthly dummy variables, omitting the dummy variable associated with the month of December. Fitted values are then given by: <span class="math inline">\(\hat{y}_t = \hat{\alpha}+\sum_{i=1}^{11}\hat{\delta}_{i}d_{it}\)</span>, which we overlay onto the time series:</p>
<div class="figure">
<span style="display:block;" id="fig:fitmiles"></span>
<p class="caption marginnote shownote">
Figure 5.2: Fitted monthly dummy variables
</p>
<img src="forecasting_files/figure-html/fitmiles-1.png" alt="Fitted monthly dummy variables" width="624">
</div>
<p>As observed, the fitted series mimic the seasonal pattern of the U.S. vehicle miles traveled exceedingly well.</p>
</div>
<div id="seasonal-harmonic-variables" class="section level3" number="5.2.2">
<h3>
<span class="header-section-number">5.2.2</span> Seasonal harmonic variables<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('seasonal-harmonic-variables')" onmouseout="reset_tooltip('seasonal-harmonic-variables-tooltip')"><span class="tooltiptext" id="seasonal-harmonic-variables-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h3>
<p>When dealing with weekly or daily data, the dummy variable approach of modeling seasonality may not be practical, nor efficient in most instances, as that will require estimating another 51 or 364 parameters. A way to model seasonality without giving up too many degrees of freedom is by using the so-called seasonal harmonic variables, which are terms from a Fourier series.</p>
<p>Fourier terms can be applied to model seasonality at any frequency. Suppose, for example, we are working with monthly time series. A model with Fourier terms will have the following form: <span class="math display">\[y_t = \alpha+\sum_{k=1}^{K}\left[\beta_{1k}\sin\left(\frac{2\pi kt}{12}\right)+\beta_{2k}\cos\left(\frac{2\pi kt}{12}\right)\right]+\varepsilon_t,\]</span> where the value of <span class="math inline">\(K\)</span> can be determined using an information criterion (e.g., AIC or SIC).</p>
<p>Consider a weekly series of initial unemployment claims filed by individuals after a separation from an employer in the United States (sourced from the online data portal of the Federal Reserve Bank of St. Louis) spanning the January 1993 – December 2008 period.</p>
<div class="figure">
<span style="display:block;" id="fig:claims"></span>
<p class="caption marginnote shownote">
Figure 5.3: Initial unemployment claims in the U.S.
</p>
<img src="forecasting_files/figure-html/claims-1.png" alt="Initial unemployment claims in the U.S." width="624">
</div>
<p>An apparent seasonal pattern is present in the series. It seems sensible to approximate the seasonality using Fourier series. Specifically, we can regress initial claims, which we denote by <span class="math inline">\(y\)</span>, on sine and cosine terms of up to order two, from a Fourier series. Fitted values are then given by: <span class="math inline">\(\hat{y}_t = \hat{\alpha}+\sum_{k=1}^{2}\left[\hat{\beta}_{1k}\sin\left(\frac{2\pi kt}{52.143}\right)+\hat{\beta}_{2k}\cos\left(\frac{2\pi kt}{52.143}\right)\right]\)</span>, which we overlay onto the time series:</p>
<div class="figure">
<span style="display:block;" id="fig:fitclaims"></span>
<p class="caption marginnote shownote">
Figure 5.4: Fitted Fourier terms up to order two
</p>
<img src="forecasting_files/figure-html/fitclaims-1.png" alt="Fitted Fourier terms up to order two" width="624">
</div>
<p>The fitted series mimic the general seasonal pattern reasonably well. There are some major departures at times, however. Especially so in the first week of the year, for example. While we could add higher order terms from a Fourier series to try and better approximate the seasonal pattern, perhaps a more efficient approach would be to simply add a dummy variable for the first week of the year, which should account for the beginning-of-calendar-year spike in the series.</p>
</div>
</div>
<div id="forecasting-1" class="section level2" number="5.3">
<h2>
<span class="header-section-number">5.3</span> Forecasting<div class="tooltip"><button class="internal-link-btn" onclick="copy_link('forecasting-1')" onmouseout="reset_tooltip('forecasting-1-tooltip')"><span class="tooltiptext" id="forecasting-1-tooltip">Copy link</span><i class="fa fa-link"></i></button></div>
</h2>
<p>As it was the case with trend models, the predictors of the seasonal models are pre-determined. This means, after fitting the model, we can readily obtain point and interval forecasts for any horizon <span class="math inline">\(h\)</span>.</p>
<p>To illustrate, consider the seasonal dummy variable model. A future realization of the random variable is: <span class="math display">\[y_{t+h} = \alpha + \sum_{i=1}^{s-1}\delta_i d_{i,t+h} + \varepsilon_{t+h}.\]</span></p>
<p>Point forecast of <span class="math inline">\(y_{t+h}\)</span> is: <span class="math display">\[\hat{y}_{t+h|t} = E(y_{t+h}|\Omega_t;\hat{\theta}) = \hat{\alpha} + \sum_{i=1}^{s-1}\hat{\delta}_i d_{i,t+h}\]</span></p>
<p>As before, we will assume that parameter estimates are equal to the true parameters of the model, so that the forecast error is: <span class="math display">\[e_{t+h|t} = y_{t+h} - y_{t+h|t} = \varepsilon_{t+h}\]</span></p>
<p>The forecast variance is: <span class="math display">\[\sigma_{t+h|t}^2 = E(e_{t+h|t}^2) =  E(\varepsilon_{t+h}^2) = \hat{\sigma}^2_{\varepsilon},\;~~\forall\;h\]</span></p>
<p>The interval forecast is: <span class="math display">\[y_{t+h|t} \pm 1.96 \hat{\sigma}_{\varepsilon}.\]</span></p>
<p>To illustrate the foregoing, let’s revisit the U.S. vehicle miles traveled data, and obtain point and interval forecasts for periods from January 2011 onward based on parameter estimates using data up to and including December 2010.</p>
<div class="figure">
<span style="display:block;" id="fig:formiles"></span>
<p class="caption marginnote shownote">
Figure 5.5: Seasonal forecast
</p>
<img src="forecasting_files/figure-html/formiles-1.png" alt="Seasonal forecast" width="624">
</div>

</div>
</div>
<p style="text-align: center;">
<a href="trends.html"><button class="btn btn-default">Previous</button></a>
<a href="autoregression.html"><button class="btn btn-default">Next</button></a>
</p>
<p class="build-date">Page built: 
2022-10-08
 using 
R version 4.1.2 (2021-11-01)
</p>
</div>
</div>



</body>
</html>
